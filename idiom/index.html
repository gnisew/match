<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¥·çƒè¡£è¡Œæˆèª</title>
	<link rel="stylesheet" href="https://oikasu1.github.io/fonts/twfonts.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
			user-select: none;
        }
        .container {
            background-color: white;
	  	    justify-content: center;
		    align-items: center;
            padding: 30px 20px 20px 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 800px;
            width: 100%;
        }
        .setup, .game {
            display: none;
        }
        .active {
            display: block;
        }
        select, button {
            margin: 10px;
            padding: 5px 10px;
        }
        .item-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 20px;
        }
        .left-item, .right-item {
            margin: 5px;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
			border: 2px solid #fff;			
        }

        .left-item:hover, .right-item:hover {
            background-color: #c0f0c0;
        }

        .left-item {
			background-color: #f3f3f3;
			font-family: BpmfZihiSans-Regular;	
			font-size: 1.3em;
        }

        .right-item {
			background-color: #eaeaea;
        }

        .selected {
            background-color: #4CAF50;
            color: white;
        }

        .selected:hover {
            background-color: #299920;
            color: white;
        }

		.left-item.correct, .right-item.correct {
			background-color: #fff !important;
			color: #1B5E20;
			border: 2px solid #AACC88;
		}

        #start-button, #view-idioms-button {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

		#next-button-container {
			display: flex;
			justify-content: space-between;
			margin-top: 10px;
		}
		#next-button, #end-button {
			width: calc(50% - 5px);
			height: 40px;
			padding: 10px;
			background-color: #4CAF50;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			visibility: hidden;
			opacity: 0;
			transition: opacity 0.3s ease;
		}

		#next-button.visible, #end-button.visible {
			visibility: visible;
			opacity: 1;
		}



		#return-to-setup {
			display: block;
			margin-top: 20px;
			padding: 10px 20px;
			background-color: #4CAF50;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
		}
        .progress-container {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .close-button {
            margin-right: 40px;
            cursor: pointer;
            font-size: 20px;
        }

        .progress-bar {
            flex-grow: 1;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }
        .progress {
            height: 100%;
            background-color: #4CAF50;
            width: 0%;
            transition: width 0.3s ease;
        }
        .round-info {
            margin-left: 10px;
            font-weight: bold;
        }
        #character {
		font-size: 1.5em;
            transition: transform 0.3s ease;
        }
        #character.animated {
            transform: scale(1.5);
        }

		.result {
			display: none;
	  	    justify-content: center;
		    align-items: center;
			margin: 20px auto;
			max-width: 400px;
			padding: 20px;
			border-radius: 10px;

		}

		.result h2 {
			text-align: center;
			margin-bottom: 20px;
			color: #333;
		}

		.result p {
			margin: 10px 0;
			font-size: 16px;
			color: #555;
		}

		.accuracy-container {
		 text-align: center;
		}

		.accuracy-bar {
			flex-grow: 1;
			height: 20px;
			background-color: #e0e0e0;
			border-radius: 10px;
			margin-left: 10px;
			overflow: hidden;
		}

		#accuracy-progress {
			height: 100%;
			background-color: #4CAF50;
			width: 0%;
			transition: width 0.5s ease-in-out;
		}

		#return-to-setup {
			display: block;
			width: 100%;
			margin-top: 20px;
			padding: 10px;
			background-color: #4CAF50;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			font-size: 16px;
			transition: background-color 0.3s;
		}

		#return-to-setup:hover {
			background-color: #45a049;
		}

		@media (max-width: 768px) {
			.right-item {
				margin-top: -5px;
				margin-bottom: 5px;
			}
		}

		@media (max-width: 768px) {
			.game {
				height: 90vh;
				overflow-y: auto;
				scrollbar-width: none;
				-ms-overflow-style: none;
			}

			.game::-webkit-scrollbar {
				display: none;
			}
		}

		@media (max-width: 768px) {
			.item-container {
				flex-direction: column;
				align-items: stretch;
			}

			#leftContainer {
				flex-direction: row;
				flex-wrap: wrap;
				justify-content: space-between;
			}

			#leftContainer .left-item {
				width: calc(50% - 10px);
				box-sizing: border-box;\				
			}

			#rightContainer .right-item {
				width: calc(100% - 30px);
				margin-bottom: 10px;
			}

			#next-button-container {
				flex-direction: row;
			}

			#next-button, #end-button {
				width: calc(50% - 5px);
			}


		}

		.sound-button {

			margin: 0px 5px;
			cursor: pointer;
			font-size: 20px;
		}

.idiom-list {
    background-color: white;
    padding: 10px 20px;
    border-radius: 10px;
    width: calc(100% - 40px);
    margin: 0 auto;
	height: 70vh;
    position: relative;
}

.idiom-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    position: relative;
}

.idiom-header h2 {
    margin: 0;
    flex-grow: 1;
    text-align: center;
}

.idiom-header .close-button {
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    font-size: 1.5em;
    cursor: pointer;
    padding: 0;
}

.list-close-button {
    background: none;
    border: none;
    font-size: 1.2em;
    cursor: pointer;
    padding: 0;
}

/* ç¢ºä¿å…¶ä»–é—œé–‰æŒ‰éˆ•ä¸å—å½±éŸ¿ */
.close-button:not(#close-idiom-list) {
    position: static;
    transform: none;
}





.close-button {
    background: none;
    border: none;
    font-size: 1.5em;
    cursor: pointer;
    color: #333;
}

.idiom-controls {
    margin-bottom: 10px;
}

.idiom-controls label {
    margin-right: 10px;
}




.idiom-table-container {
    overflow-x: auto;
    max-height: calc(80vh - 130px);
}

#idiom-table {
    width: 100%;
    border-collapse: collapse;
}

#idiom-table thead {
    position: sticky;
    top: 0;
	padding: 20px;
    background-color: #f2f2f2;
    z-index: 1;
}

#idiom-table th  {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: center;
}

#idiom-table td {
    border: 1px solid #ddd;
    padding: 5px 5px 5px 10px;
    text-align: left;
}



.small-number{
    color: #ff5555;
	font-size: 0.4em;
}

.idiom {
    min-width: 130px;
	font-size: 1.1em;
	font-family: BpmfZihiSans-Regular;
}




#idiom-table th {
    background-color: #e1e1e1;
}

#idiom-table tbody tr:nth-child(odd) {
    background-color: #f8f8f8;
}

#idiom-table tbody tr:nth-child(even) {
    background-color: #fefefe;
}

@media (max-width: 768px) {
    .idiom-list {
        padding: 10px;
        max-height: 90vh;
    }

    .idiom-controls {
        display: flex;
        flex-wrap: wrap;
    }

    .idiom-controls label {
        margin-bottom: 10px;
    }

    #idiom-table {
        font-size: 14px;
    }
    
    #idiom-table th, #idiom-table td {
        padding: 5px;
    }
}

.category-navigation {
    display: flex;
    justify-content: space-between;
    margin-bottom: 0px;
}

.nav-button {
    padding: 5px 10px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
}

.nav-button:hover {
    background-color: #45a049;
}

.nav-button:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
}
.font-toggle-button {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    border: 1px solid #4CAF50;
    background-color: white;
    color: #4CAF50;
    font-size: 12px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    margin-right: 5px;
}
    </style>
</head>
<body>
    <div class="container">
		<div class="setup active" id="setup">
			<h1 id="myTitle">ğŸ¥·çƒè¡£è¡Œæˆèª</h1>
			<div>
				<label for="category-select">åˆ†é¡ï¼š</label>
				<select id="category-select">
					<option value="all">æ‰€æœ‰åˆ†é¡</option>
					<!-- å…¶ä»–åˆ†é¡é¸é …å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
				</select>
			</div>
			<div>
				<label for="match-type-select">é…å°ï¼š</label>
				<select id="match-type-select">
					<option value="æˆèª-è¡¨é”æ„æ€">æˆèª - è¡¨é”æ„æ€</option>
					<option value="æˆèª-å­—é¢æ„æ€">æˆèª - å­—é¢æ„æ€</option>
					<option value="æˆèª-ä¾‹å¥">æˆèª - ä¾‹å¥</option>
				</select>
			</div>
			<div>
				<label for="order-select">é †åºï¼š</label>
				<select id="order-select">
					<option value="random">éš¨æ©Ÿ</option>
					<option value="sequential">ä¾åº</option>
				</select>
			</div>			
			<button id="view-idioms-button">æª¢è¦–æˆèª ğŸ”</button>
			<button id="start-button">é–‹å§‹éŠæˆ² ğŸš€</button>
		</div>
        <div class="game" id="game">
			<div class="progress-container">
				<div class="close-button" id="close-button">âœ–ï¸</div>				
				<div class="progress-bar">
					<div class="progress" id="progress"></div>
				</div>
				<div class="round-info" id="round-info"></div>
				<div class="sound-button" id="sound-button">ğŸ””</div>
				<div class="font-toggle-button" id="font-toggle-button">å­—</div>
			</div>
            <h1><span id="character">ğŸ™‚</span></h1>
            <div class="item-container" id="leftContainer"></div>
            <div class="item-container" id="rightContainer"></div>
            <div id="next-button-container">                
				<button id="end-button">ğŸ‰ çµæŸ</button>
				<button id="next-button">ä¸‹ä¸€é¡Œ ğŸš€</button>
            </div>
        </div>

		<div class="idiom-list" id="idiom-list" style="display: none;">
			<div class="category-navigation">
				<button id="prev-category" class="nav-button">ä¸Šä¸€åˆ†é¡</button>
				<button id="next-category" class="nav-button">ä¸‹ä¸€åˆ†é¡</button>
			</div>
			<div class="idiom-header">
			<button id="close-idiom-list" class="list-close-button">âœ–ï¸</button>
				<h2>æˆèªåˆ—è¡¨</h2>
				
				<div class="font-toggle-button" id="list-font-toggle-button">å­—</div>
			</div>

			<div class="idiom-controls">
				<label><input type="checkbox" id="show-category" checked>åˆ†é¡</label>
				<label><input type="checkbox" id="show-idiom" checked>æˆèª</label>
				<label><input type="checkbox" id="show-literal" checked>å­—é¢</label>
				<label><input type="checkbox" id="show-figurative" checked>ç”¨æ„</label>
				<label><input type="checkbox" id="show-example">ä¾‹å¥</label>
			</div>
			<div class="idiom-table-container">
				<table id="idiom-table">
					<thead>
						<tr>
							<th class="category">åˆ†é¡</th>
							<th class="idiom">æˆèª</th>
							<th class="literal">å­—é¢æ„æ€</th>
							<th class="figurative">è¡¨é”æ„æ€</th>
							<th class="example">ä¾‹å¥</th>
						</tr>
					</thead>
					<tbody>
						<!-- æˆèªè³‡æ–™å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
					</tbody>
				</table>
			</div>
		</div>

		<div id="result" class="result">
			<h2>ğŸ¥·çƒè¡£è¡Œæˆèª</h2>
		
				<div class="accuracy-bar">
					<div id="accuracy-progress"></div>
				</div>

			<div class="accuracy-container">		
				<p id="accuracy"></p>
				<p id="time-spent"></p>
				<p id="total-rounds"></p>
				<p id="total-pairs"></p>
				<p id="selected-category"></p>
				<p id="match-type-result"></p>
				<p id="order-type-result"></p>
			</div>
			<button id="return-to-setup">è¿”å› ğŸ›¸</button>
		</div>

    </div>

    <script>
        const idiomsData = `
åˆ†é¡	æˆèª	å­—é¢æ„æ€	è¡¨é”æ„æ€	ä¾‹å¥
æ™ºæ…§æ‰èƒ½	ä»å¿ƒä»è¡“	ä»æ…ˆçš„å¿ƒè…¸å’Œä»æ„›çš„æŠ€è¡“	å½¢å®¹æ—¢å…·åŒæƒ…å¿ƒåˆæœ‰é«˜è¶…æŠ€è¡“çš„äººï¼Œç‰¹åˆ¥æŒ‡é†«ç”Ÿ	é‚£ä½é†«ç”Ÿä¸åƒ…é†«è¡“ç²¾æ¹›ï¼Œé‚„å°ç—…äººç‰¹åˆ¥é—œæ‡·ï¼ŒçœŸæ˜¯ä»å¿ƒä»è¡“çš„å…¸ç¯„ã€‚|åœ¨ç½å€ï¼Œä»–å€‘å±•ç¾å‡ºä»å¿ƒä»è¡“ï¼Œç„¡ç§åœ°æ•‘åŠ©æ¯ä¸€ä½éœ€è¦å¹«åŠ©çš„äººã€‚
æ™ºæ…§æ‰èƒ½	æ‰é«˜å…«æ–—	æ‰èƒ½é«˜é”å…«æ–—ä¹‹å¤š	å½¢å®¹æ‰å­¸æ¥µç‚ºå„ªç§€	é€™ä½å¹´è¼•ä½œå®¶æ‰é«˜å…«æ–—ï¼Œä½œå“å‚™å—è®šè­½ã€‚|é€™ä½ä½œå®¶æ‰é«˜å…«æ–—ï¼Œä½œå“å»£å—å¥½è©•ï¼Œæ–‡åé æšã€‚
æ™ºæ…§æ‰èƒ½	è¦‹å¾®çŸ¥è‘—ó ‡¡	çœ‹åˆ°å¾®å°å°±çŸ¥é“é¡¯è‘—çš„	å¾ç´°å¾®è™•è¦‹è­˜åˆ°äº‹ç‰©çš„æœ¬è³ª	å„ªç§€çš„ç®¡ç†è€…èƒ½å¤ è¦‹å¾®çŸ¥è‘—ï¼Œé˜²æ‚£æ–¼æœªç„¶ã€‚|å¾ä¸€é»å°äº‹ä¸­ï¼Œä»–è¦‹å¾®çŸ¥è‘—ï¼Œé è¦‹äº†å¾ŒçºŒç™¼å±•çš„è¶¨å‹¢ã€‚
æ™ºæ…§æ‰èƒ½	åå‰¯å…¶å¯¦	åç¨±ç¬¦åˆå¯¦éš›	åç¨±èˆ‡å¯¦éš›ç›¸ç¬¦åˆ	é€™å®¶é¤å»³çš„æ‹›ç‰Œèœåå‰¯å…¶å¯¦ï¼Œå‘³é“ç¢ºå¯¦ä¸€æµã€‚|é€™å®¶é¤å»³çš„ç¾é£Ÿç¢ºå¯¦åå‰¯å…¶å¯¦ï¼Œå€¼å¾—ä¸€è©¦ã€‚
æ™ºæ…§æ‰èƒ½	æ°´åˆ°æ¸ æˆ	æ°´ä¾†äº†æ¸ é“å°±æˆå½¢äº†	äº‹æƒ…æ°´åˆ°æ¸ æˆï¼Œé †åˆ©æˆåŠŸ	åªè¦åŠªåŠ›ï¼ŒæˆåŠŸè‡ªç„¶æ°´åˆ°æ¸ æˆã€‚|ç¶“éé•·æœŸçš„æº–å‚™ï¼Œé …ç›®æœ€çµ‚é †åˆ©å®Œæˆï¼ŒçœŸæ˜¯æ°´åˆ°æ¸ æˆã€‚
æ™ºæ…§æ‰èƒ½	ä¼¯æ¨‚ç›¸é¦¬	ä¼¯æ¨‚å–„æ–¼ç›¸é¦¬	å–„æ–¼ç™¼ç¾äººæ‰	é€™ä½æ˜Ÿæ¢å–„æ–¼ä¼¯æ¨‚ç›¸é¦¬ï¼Œç™¼æ˜äº†è¨±å¤šæ¼”è—æ–°ç§€ã€‚|åœ¨ä»–çš„æ¨è–¦ä¸‹ï¼Œé‚£ä½æ–°äººå¾—åˆ°äº†é‡ç”¨ï¼ŒçœŸæ˜¯ä¼¯æ¨‚ç›¸é¦¬ã€‚
æ™ºæ…§æ‰èƒ½	é›€å±ä¸­é¸	éº»é›€åœ¨å±é¢¨ä¸­è¢«é¸ä¸­	åœ¨çœ¾å¤šç«¶çˆ­è€…ä¸­è„«ç©è€Œå‡º	åœ¨æ¿€çƒˆçš„ç«¶çˆ­ä¸­ï¼Œä»–é›€å±ä¸­é¸ï¼ŒæˆåŠŸæ™‰ç´šã€‚|åœ¨çœ¾å¤šæ‡‰è˜è€…ä¸­ï¼Œä»–æ†‘è—‰å‡ºè‰²çš„è¡¨ç¾é›€å±ä¸­é¸ï¼Œç²å¾—äº†é€™ä»½å·¥ä½œã€‚
å‹¤å¥®å­¸ç¿’	å­œå­œä¸ó ‡¡å€¦	å‹¤å‹‰ä¸ç–²å€¦	å‹¤å¥®ä¸æ‡ˆ	ç§‘å­¸å®¶å€‘å­œå­œä¸å€¦åœ°ç ”ç©¶ï¼Œçµ‚æ–¼å–å¾—é‡å¤§çªç ´ã€‚|ä»–å­œå­œä¸å€¦åœ°è¿½æ±‚çœŸç†ï¼Œä¸æ–·æ¢ç´¢æ–°çš„çŸ¥è­˜é ˜åŸŸã€‚
å‹¤å¥®å­¸ç¿’	æ‰‹ä¸ó ‡¡é‡‹å·	æ‰‹ä¸æ”¾ä¸‹æ›¸å·	å½¢å®¹å‹¤å¥®å¥½å­¸	å¥¹æ±‚å­¸æ™‚æœŸæ‰‹ä¸é‡‹å·ï¼Œæœ€çµ‚è€ƒä¸Šäº†ç†æƒ³çš„å¤§å­¸ã€‚|ä»–ç‚ºäº†è€ƒè©¦ï¼Œæ—¥å¤œè‹¦è®€ï¼Œæ‰‹ä¸é‡‹å·ï¼Œæœ€çµ‚å–å¾—äº†å¥½æˆç¸¾ã€‚
å‹¤å¥®å­¸ç¿’	ç”˜ä¹‹å¦‚é£´	ç”œå¦‚ç³–é£´	æŠŠè‹¦äº‹ç•¶ä½œç”œäº‹ä¾†åš	ä»–å°ç¹é‡çš„å·¥ä½œç”˜ä¹‹å¦‚é£´ï¼Œå¾ä¸æŠ±æ€¨ã€‚|é›–ç„¶å·¥ä½œè‰±è¾›ï¼Œä½†ä»–ç”˜ä¹‹å¦‚é£´ï¼Œæ¨‚åœ¨å…¶ä¸­ã€‚
å‹¤å¥®å­¸ç¿’	é€†æ°´è¡ŒèˆŸ	é€†è‘—æ°´æµåˆ’èˆ¹	æ¯”å–»å­¸ç¿’è¦ä¸æ–·åŠªåŠ›	å‰µæ¥­ç¶­è‰±ï¼Œå¦‚åŒé€†æ°´è¡ŒèˆŸï¼Œä¸é€²å‰‡é€€ã€‚|å­¸ç¿’å¦‚åŒé€†æ°´è¡ŒèˆŸï¼Œä¸é€²å‰‡é€€ï¼Œå¿…é ˆä¸æ–·åŠªåŠ›ã€‚
å‹¤å¥®å­¸ç¿’	å›«åœ‡åæ£—	æ•´é¡†åä¸‹æ£—å­	å­¸ç¿’ä¸æ±‚ç”šè§£	è€ƒè©¦å‰æ€¥æ–¼è¤‡ç¿’çš„å­¸ç”Ÿå¾€å¾€å›«åœ‡åæ£—ï¼Œæ•ˆæœä¸ä½³ã€‚|å­¸ç¿’çŸ¥è­˜ä¸èƒ½å›«åœ‡åæ£—ï¼Œæ‡‰è©²ç´°ç´°å“å‘³ï¼Œæ·±å…¥ç†è§£ã€‚
å …æ¯…ç²¾ç¥	ç™¾æŠ˜ä¸æ’“	ç™¾æ¬¡æŠ˜å½ä¹Ÿä¸å±ˆæœ	å±¢é‡æŒ«æŠ˜è€Œä¸å±ˆæœ	å¥¹é¢å°æŒ«æŠ˜ç™¾æŠ˜ä¸æ’“ï¼Œæœ€çµ‚æˆåŠŸå‰µæ¥­ã€‚|é¢å°å¤šæ¬¡æŒ«æŠ˜ï¼Œä»–ä¾ç„¶ç™¾æŠ˜ä¸æ’“ï¼Œæœ€çµ‚å–å¾—äº†æˆåŠŸã€‚
å …æ¯…ç²¾ç¥	ç–¾é¢¨å‹è‰	å¼·é¢¨ä¸­çš„å‹è‰	æ¯”å–»åœ¨é€†å¢ƒä¸­å …å¼·ä¸å±ˆçš„äºº	é¢å°å›°å¢ƒï¼Œä»–å¦‚ç–¾é¢¨å‹è‰ï¼Œæ„ˆæŒ«æ„ˆå‹‡ã€‚|åœ¨ç–¾é¢¨å‹è‰çš„è€ƒé©—ä¸‹ï¼ŒçœŸæ­£çš„è‹±é›„æ‰èƒ½è„«ç©è€Œå‡ºã€‚
å …æ¯…ç²¾ç¥	ç ´é‡œæ²‰èˆŸ	æ‰“ç ´é‹é‡œæ²‰æ²’èˆ¹éš»	æ¯”å–»ä¸‹å®šæ±ºå¿ƒï¼Œä¸ç•™é€€è·¯	è»éšŠç ´é‡œæ²‰èˆŸï¼Œå±•ç¾å¿…å‹çš„æ±ºå¿ƒã€‚|ä»–ä¸‹å®šæ±ºå¿ƒï¼Œç ´é‡œæ²‰èˆŸï¼Œä¸€å®šè¦å®Œæˆé€™å€‹é …ç›®ã€‚
äººéš›é—œä¿‚	åŒèˆŸå…±æ¿Ÿ	åŒåä¸€æ¢èˆ¹å…±åŒæ¸¡æ²³	æ¯”å–»åŒå¿ƒå”åŠ›ï¼Œå…±æ¸¡é›£é—œ	åœ¨å›°é›£æ™‚æœŸï¼Œå…¨é«”å“¡å·¥åŒèˆŸå…±æ¿Ÿï¼Œå…±åº¦é›£é—œã€‚|é¢å°å›°é›£ï¼Œå¤§å®¶å¿…é ˆåŒèˆŸå…±æ¿Ÿï¼Œæ‰èƒ½åº¦éé›£é—œã€‚
äººéš›é—œä¿‚	ç®¡é®‘ä¹‹äº¤	ç®¡ä»²å’Œé®‘å”çš„äº¤æƒ…	å½¢å®¹æœ‹å‹ä¹‹é–“éå¸¸è¦å¥½	ä»–å€‘å€†å¯è¬‚ç®¡é®‘ä¹‹äº¤ï¼Œæƒ…èª¼æ·±åšã€‚|ä»–å€‘å…©äººçš„å‹èª¼æ·±åšï¼Œå ªç¨±ç¾ä»£çš„ç®¡é®‘ä¹‹äº¤ã€‚
äººéš›é—œä¿‚	é¶¼é°ˆæƒ…æ·±	éµå’Œé´›é´¦çš„æ„Ÿæƒ…æ·±åš	æ¯”å–»å¤«å¦»æ©æ„›	é€™å°è€å¤«å¦»é¶¼é°ˆæƒ…æ·±ï¼Œä»¤äººç¾¨æ…•ã€‚|ä»–å€‘å¤«å¦»å€†é¶¼é°ˆæƒ…æ·±ï¼Œè®“äººååˆ†ç¾¨æ…•ã€‚
äººéš›é—œä¿‚	æˆ¶æ¨ä¸ó ‡¡è ¹	é–€æ¨ä¸æœƒè¢«èŸ²è›€	æ¯”å–»ç¶“å¸¸åšäº‹çš„äººä¸æœƒç”Ÿç–	è€ç‹å¾äº‹æ•™è‚²å·¥ä½œå¤šå¹´ï¼Œç¶“é©—è±å¯Œï¼Œå¯è¬‚æˆ¶æ¨ä¸è ¹ã€‚|ä¿—è©±èªªï¼Œæˆ¶æ¨ä¸è ¹ï¼Œæµæ°´ä¸è…ï¼Œä¿æŒæ´»å‹•æ‰èƒ½ä¿æŒæ´»åŠ›ã€‚
æ•™è‚²èˆ‡æˆé•·	å› ææ–½æ•™	æ ¹æ“šæ‰èƒ½æ–½è¡Œæ•™è‚²	æ ¹æ“šä¸åŒçš„äººå› ææ–½æ•™	å¥½è€å¸«éƒ½æ‡‚å¾—å› ææ–½æ•™ï¼Œè®“æ¯å€‹å­¸ç”Ÿéƒ½èƒ½ç™¼æ®æ‰€é•·ã€‚|è€å¸«æ ¹æ“šå­¸ç”Ÿçš„ä¸åŒç‰¹é»å› ææ–½æ•™ï¼Œå–å¾—äº†è‰¯å¥½çš„æ•™å­¸æ•ˆæœã€‚
æ•™è‚²èˆ‡æˆé•·	äº¡ç¾Šè£œç‰¢	å¤±å»ç¾Šå¾Œä¿®è£œç¾Šåœˆ	äº¡ç¾Šå¾Œè£œç‰¢ï¼Œäº¡ç¾Šå¾Œè£œç‰¢ï¼Œç‚ºæ™‚æœªæ™š	é€™æ¬¡å¤±èª¤å¾Œï¼Œå…¬å¸ç«‹å³æ¡å–æªæ–½ï¼Œå¯è¬‚äº¡ç¾Šè£œç‰¢ã€‚|é›–ç„¶éŒ¯éäº†æœ€ä½³æ™‚æ©Ÿï¼Œä½†ä»–é‚„æ˜¯è¶•ç·Šäº¡ç¾Šè£œç‰¢ï¼Œé¿å…æ›´å¤§çš„æå¤±ã€‚
æ•™è‚²èˆ‡æˆé•·	ç¹¼å¾€é–‹ä¾†	ç¹¼æ‰¿éå»é–‹å‰µæœªä¾†	ç¹¼æ‰¿å‰äººï¼Œé–‹å‰µæœªä¾†	æ–°ä¸€ä»£é ˜å°äººç¹¼å¾€é–‹ä¾†ï¼Œæ¨å‹•åœ‹å®¶é€²æ­¥ã€‚|æˆ‘å€‘æ‡‰ç¹¼å¾€é–‹ä¾†ï¼Œå°‡å‰äººçš„ç²¾ç¥ç™¼æšå…‰å¤§ï¼Œè¿æ¥æœªä¾†æŒ‘æˆ°ã€‚
è¨€èªè¡¨é”	ä¸€ó ‡¢è¨€ä¹é¼	ä¸€å¥è©±çš„åˆ†é‡å¦‚åŒä¹å€‹é¼é‚£éº¼é‡	å½¢å®¹èªªè©±æ¥µæœ‰åˆ†é‡	ä»–çš„æ‰¿è«¾å¦‚ä¸€è¨€ä¹é¼ï¼Œå¤§å®¶éƒ½ååˆ†ä¿¡è³´ã€‚|ä»–åœ¨å…¬å¸ä¸­çš„åœ°ä½æ¥µé«˜ï¼Œä¸€è¨€ä¹é¼ï¼Œæ±ºç­–å…·æœ‰æ¥µå¤§çš„å½±éŸ¿åŠ›ã€‚
è¨€èªè¡¨é”	è¨€çŒ¶åœ¨è€³	èªªçš„è©±é‚„åœ¨è€³é‚Š	å‰›èªªéçš„è©±é‚„åœ¨è€³é‚Šå›éŸ¿	çˆ¶è¦ªçš„æ•™èª¨è¨€çŒ¶åœ¨è€³ï¼ŒæŒ‡å¼•è‘—æˆ‘çš„äººç”Ÿæ–¹å‘ã€‚|è€å¸«çš„æ•™èª¨è¨€çŒ¶åœ¨è€³ï¼Œä»–å§‹çµ‚éŠ˜è¨˜åœ¨å¿ƒã€‚
è¨€èªè¡¨é”	è«‡ç¬‘é¢¨ç”Ÿ	è«‡ç¬‘ä¸­é¢¨è¶£æ©«ç”Ÿ	è«‡åè‡ªå¦‚ï¼Œèªªè©±æœ‰è¶£	é…’éä¸‰å·¡ï¼Œçœ¾äººè«‡ç¬‘é¢¨ç”Ÿï¼Œå…¶æ¨‚èèã€‚|èšæœƒä¸Šå¤§å®¶è«‡ç¬‘é¢¨ç”Ÿï¼Œæ°£æ°›ç›¸ç•¶æ„‰å¿«ã€‚
è¬¹æ…è¡Œäº‹	ç®­åœ¨å¼¦ä¸Š	ç®­å·²ç¶“æ­åœ¨å¼¦ä¸Šäº†	äº‹æƒ…å·²åˆ°ç·Šè¦é—œé ­	è¨ˆåŠƒå·²ç¶“æˆç†Ÿï¼Œç®­åœ¨å¼¦ä¸Šï¼Œä¸å¾—ä¸ç™¼ã€‚|äº‹æƒ…å·²ç¶“ç™¼å±•åˆ°é€™ç¨®åœ°æ­¥ï¼Œç°¡ç›´æ˜¯ç®­åœ¨å¼¦ä¸Šï¼Œä¸å¾—ä¸ç™¼ã€‚
è¬¹æ…è¡Œäº‹	æƒœå¢¨å¦‚é‡‘	çæƒœå¢¨å¦‚åŒé»ƒé‡‘	çæƒœæ–‡å­—å¦‚åŒçæƒœé»ƒé‡‘	å¤ä»£ç´™å¢¨æ˜‚è²´ï¼Œå­¸å­å€‘æƒœå¢¨å¦‚é‡‘ã€‚|é€™ä½æ›¸æ³•å®¶æƒœå¢¨å¦‚é‡‘ï¼Œæ¯ä¸€ç­†éƒ½ä¸‹å¾—ååˆ†è¬¹æ…ã€‚
è¬¹æ…è¡Œäº‹	å–®åˆ€ç›´å…¥	å–®æŠŠåˆ€ç›´æ¥é€²å…¥	ç›´æˆªäº†ç•¶åœ°èªªæ˜ä¾†æ„	ä»–å–®åˆ€ç›´å…¥åœ°æŒ‡å‡ºäº†å•é¡Œçš„ç™¥çµã€‚|ä»–åœ¨æœƒè­°ä¸­å–®åˆ€ç›´å…¥ï¼Œç›´æ¥æå‡ºäº†å•é¡Œçš„é—œéµæ‰€åœ¨ã€‚
è² é¢è¡Œç‚º	è½äº•ä¸‹çŸ³	å‘æ‰é€²äº•è£¡çš„äººæ‰”çŸ³é ­	è¶äººè™•æ–¼å›°å¢ƒè½äº•ä¸‹çŸ³	æœ‹å‹é­é‡å›°å¢ƒï¼Œæˆ‘å€‘æ‡‰è©²ä¼¸å‡ºæ´æ‰‹ï¼Œè€Œä¸æ˜¯è½äº•ä¸‹çŸ³ã€‚|ä»–åœ¨æœ‹å‹å›°é›£æ™‚ä¸åƒ…æ²’æœ‰å¹«åŠ©ï¼Œåè€Œè½äº•ä¸‹çŸ³ï¼Œè®“äººå¿ƒå¯’ã€‚
è² é¢è¡Œç‚º	æš—ç®­å‚·äºº	æš—ä¸­å°„ç®­å‚·äºº	æš—ä¸­å‚·å®³ä»–äºº	è·å ´ä¸­æš—ç®­å‚·äººçš„äº‹æ™‚æœ‰ç™¼ç”Ÿï¼Œè¦å¤šåŠ å°å¿ƒã€‚|ä»–åœ¨èƒŒå¾Œæ•£æ’­æµè¨€ï¼Œæš—ç®­å‚·äººï¼Œè®“äººç„¡æ³•é˜²å‚™ã€‚
è² é¢è¡Œç‚º	ç‹å‡è™å¨	ç‹ç‹¸å‡å€Ÿè€è™çš„å¨é¢¨	ä»—å‹¢æ¬ºäºº	ä»—è‘—ä¸Šå¸çš„æ¬Šå‹¢ï¼Œä»–ç¶“å¸¸ç‹å‡è™å¨ã€‚|é‚£å€‹å°ä¸»ç®¡ç‹å‡è™å¨ï¼Œä»—å‹¢æ¬ºäººï¼Œè®“äººååˆ†åæ„Ÿã€‚
è² é¢è¡Œç‚º	å¥½ó ‡¡é€¸æƒ¡ó ‡¡å‹	å–œæ­¡å®‰é€¸å­æƒ¡å‹å‹•	è²ªåœ–å®‰é€¸ï¼Œè¨å­å‹å‹•	ä»–æ•´å¤©èººåœ¨æ²™ç™¼ä¸Šçœ‹é›»è¦–ï¼ŒçœŸæ˜¯å¥½é€¸æƒ¡å‹ã€‚|ä»–å¥½é€¸æƒ¡å‹ï¼Œä¸é¡˜åŠªåŠ›å·¥ä½œï¼Œç”Ÿæ´»è‡ªç„¶ä¸æœƒé †åˆ©ã€‚
è² é¢è¡Œç‚º	ç•«è™é¡ç‹—	ç•«è€è™å»ç•«å¾—åƒç‹—	æ‹™åŠ£çš„æ¨¡ä»¿	ä»–è‡ªè©¡ç‚ºæ›¸æ³•å®¶ï¼Œä½†ä½œå“å¯¦åœ¨æ˜¯ç•«è™é¡ç‹—ã€‚|ä»–æ¨¡ä»¿åå®¶ä½œç•«ï¼Œä½†çµæœå»ç•«è™é¡ç‹—ï¼Œè®“äººå¤±æœ›ã€‚
æƒ…æ„Ÿç‹€æ…‹	æ‚µç„¶è‹¥å¤±	å¤±è½å¾—å¥½åƒä¸Ÿäº†æ±è¥¿	å½¢å®¹å¤±æ„æˆ–å¤±æœ›çš„æ¨£å­	ç•¢æ¥­å…¸ç¦®å¾Œï¼ŒåŒå­¸å€‘éƒ½æ„Ÿåˆ°æ‚µç„¶è‹¥å¤±ã€‚|é›¢é–‹ç†Ÿæ‚‰çš„ç’°å¢ƒï¼Œä»–æ„Ÿåˆ°æ‚µç„¶è‹¥å¤±ï¼Œå¿ƒè£¡ç©ºè½è½çš„ã€‚
æƒ…æ„Ÿç‹€æ…‹	æ¶•æ³—æ»‚æ²±	çœ¼æ·šé¼»æ¶•å¦‚å‚¾ç›†å¤§é›¨	å½¢å®¹ç—›å“­æµæ¶•çš„æ¨£å­	å¾—çŸ¥å™©è€—ï¼Œå¥¹æ¶•æ³—æ»‚æ²±ï¼Œä¹…ä¹…ä¸èƒ½å¹³å¾©ã€‚|è½åˆ°é‚£æ‚²æ…˜çš„æ•…äº‹ï¼Œå¥¹å¿ä¸ä½æ¶•æ³—æ»‚æ²±ï¼Œæ·šæµæ»¿é¢ã€‚
æƒ…æ„Ÿç‹€æ…‹	æ¯›éª¨æ‚šç„¶	æ¯›é«®å’Œéª¨é ­éƒ½è±èµ·ä¾†äº†	å½¢å®¹éå¸¸å®³æ€•çš„æ¨£å­	è½åˆ°æ·±å¤œçš„è©­ç•°è²éŸ¿ï¼Œæˆ‘æ„Ÿåˆ°æ¯›éª¨æ‚šç„¶ã€‚|è½åˆ°é‚£ææ€–çš„æ•…äº‹ï¼Œä»–ä¸ç¦æ¯›éª¨æ‚šç„¶ï¼Œæ±—æ¯›è±èµ·ã€‚
è™•å¢ƒå›°é›£	å››é¢æ¥šæ­Œ	å››é¢éƒ½æ˜¯æ¥šåœ‹çš„æ­Œè²	æ¯”å–»å››é¢å—æ•µï¼Œè™•å¢ƒå›°é›£	å…¬å¸é™·å…¥å›°å¢ƒï¼Œé¢è‡¨å››é¢æ¥šæ­Œçš„å±€é¢ã€‚|å…¬å¸å…§å¤–å•é¡Œé‡é‡ï¼Œå››é¢æ¥šæ­Œï¼Œé™·å…¥äº†å›°å¢ƒã€‚
è™•å¢ƒå›°é›£	æ±Ÿéƒæ‰ç›¡	æ±Ÿéƒçš„æ‰è¯ç”¨ç›¡äº†	æ‰æ€æ¯ç«­	é€™ä½ä½œå®¶è¿‘å¹´ä½œå“å¹³å¹³ï¼Œä¼¼ä¹æœ‰æ±Ÿéƒæ‰ç›¡ä¹‹å‹¢ã€‚|é€™ä½ä½œå®¶è¿‘æœŸä½œå“å¹³å¹³ï¼Œä¼¼ä¹æ±Ÿéƒæ‰ç›¡ï¼Œé›£ä»¥è¶…è¶Šéå»çš„è¼ç…Œã€‚
è™•å¢ƒå›°é›£	æ¢§é¼ æŠ€çª®	æ¢§æ¡æ¨¹ä¸Šçš„è€é¼ æŠ€çª®äº†	æ¯”å–»æ‰èƒ½å·²åˆ°ç›¡é ­	é¢å°å¼·å‹å°æ‰‹ï¼Œä»–å¾ˆå¿«å°±æ¢§é¼ æŠ€çª®ã€‚|ä»–é›–ç„¶æŒæ¡äº†ä¸€äº›æŠ€å·§ï¼Œä½†åœ¨é¢å°å›°é›£æ™‚å»æ¢§é¼ æŠ€çª®ï¼Œç„¡è¨ˆå¯æ–½ã€‚
è™•å¢ƒå›°é›£	é¡›æ²›æµé›¢	é¡›ç°¸å¥”æ³¢æµè½ä»–é„‰	å½¢å®¹ç”Ÿæ´»å‹•ç›ªä¸å®‰	æˆ°äº‚æ™‚æœŸï¼Œç™¾å§“é¡›æ²›æµé›¢ï¼Œç”Ÿæ´»è‰±é›£ã€‚|æˆ°çˆ­è®“è¨±å¤šå®¶åº­é¡›æ²›æµé›¢ï¼Œç”Ÿæ´»å›°è‹¦ä¸å ªã€‚
æ²»ç†æ–¹å¼	å‚æ‹±è€Œæ²»	å‚è¡£æ‹±æ‰‹å°±èƒ½æ²»ç†å¤©ä¸‹	ç„¡ç‚ºè€Œæ²»	é€™ä½é ˜å°å–„æ–¼ç”¨äººï¼Œå¹¾è¿‘å‚æ‹±è€Œæ²»ã€‚|åœ¨ä»–çš„æ²»ç†ä¸‹ï¼Œåœ‹å®¶å®‰å®šç¹æ¦®ï¼ŒçœŸæ˜¯å‚æ‹±è€Œæ²»ã€‚
æ²»ç†æ–¹å¼	å¹³åˆ†ç§‹è‰²	å¹³å‡åˆ†é…ç§‹å¤©çš„æ™¯è‰²	å‹¢å‡åŠ›æ•µï¼Œä¸ç›¸ä¸Šä¸‹	å…©æ”¯çƒéšŠå¯¦åŠ›ç›¸ç•¶ï¼Œæ¯”è³½çµæœå¹³åˆ†ç§‹è‰²ã€‚|å…©éšŠå¯¦åŠ›ç›¸ç•¶ï¼Œé€™å ´æ¯”è³½æœ€çµ‚å¹³åˆ†ç§‹è‰²ï¼Œé›£åˆ†é«˜ä¸‹ã€‚
æ‰¹è©•è­°è«–	å“é ­è«–è¶³	è©•è«–é ­å’Œè…³	å°äººæˆ–äº‹ç‰©å“é ­è«–è¶³	æ¯”è³½çµæŸå¾Œï¼Œè§€çœ¾å€‘ç´›ç´›å“é ­è«–è¶³ã€‚|ä»–å°æ¯ä»¶äº‹éƒ½å–œæ­¡å“é ­è«–è¶³ï¼Œç¸½æ˜¯æŒ‘å‰”ä¸æ»¿ã€‚
æ‰¹è©•è­°è«–	æ‹æ¡ˆå«çµ•	æ‹æ¡Œå­å«å¥½	å½¢å®¹ååˆ†è®šè³	è½å®Œä»–çš„ææ¡ˆï¼Œèˆ‡æœƒè€…éƒ½æ‹æ¡ˆå«çµ•ã€‚|ä»–çš„æ¼”æŠ€ä»¤äººé©šå˜†ï¼Œè§€çœ¾ä¸ç¦æ‹æ¡ˆå«çµ•ã€‚
è¡Œç‚ºæ…‹åº¦	æ±²æ±²ç‡Ÿç‡Ÿ	æ€¥åˆ‡åœ°è¿½æ±‚	å½¢å®¹æ€¥æ–¼è¿½æ±‚	ä»–æ•´å¤©æ±²æ±²ç‡Ÿç‡Ÿæ–¼äº‹æ¥­ï¼Œå»å¿½è¦–äº†å®¶åº­ã€‚|ä»–æ±²æ±²ç‡Ÿç‡Ÿåœ°è¿½æ±‚ååˆ©ï¼Œå»å¿½ç•¥äº†ç”Ÿæ´»ä¸­çš„çœŸæ­£åƒ¹å€¼ã€‚
è¡Œç‚ºæ…‹åº¦	æ•…æ­¥è‡ªå°	å›ºå®ˆèˆŠçš„æ­¥ä¼è‡ªæˆ‘å°é–‰	å®ˆèˆŠä¸è‚¯æ”¹é€²	åœ¨ç§‘æŠ€å¿«é€Ÿç™¼å±•çš„ä»Šå¤©ï¼Œæ•…æ­¥è‡ªå°å°‡æœƒè½å¾Œã€‚|å¦‚æœç¸½æ˜¯æ•…æ­¥è‡ªå°ï¼Œä¸é¡˜æ„æ¥å—æ–°äº‹ç‰©ï¼Œå¿…ç„¶æœƒè½å¾Œæ–¼æ™‚ä»£ã€‚
è¡Œç‚ºæ…‹åº¦	é£Ÿå¤ä¸ó ‡¡åŒ–	åƒäº†å¤ä»£çš„æ±è¥¿å»ä¸æ¶ˆåŒ–	åªçŸ¥é“æ¨¡ä»¿å¤äººï¼Œä¸çŸ¥è®Šé€š	ä»–çš„æ€æƒ³é£Ÿå¤ä¸åŒ–ï¼Œç„¡æ³•é©æ‡‰æ–°æ™‚ä»£ã€‚|ä»–é›–ç„¶è®€éè¨±å¤šæ›¸ï¼Œä½†é£Ÿå¤ä¸åŒ–ï¼Œæ€æƒ³ä»ç„¶é™³èˆŠã€‚
å½¢å®¹æ•¸é‡	æ†æ²³æ²™æ•¸	æ†æ²³ä¸­æ²™å­çš„æ•¸é‡	å½¢å®¹æ•¸é‡æ¥µå¤š	å®‡å®™ä¸­çš„æ˜Ÿçƒå¦‚æ†æ²³æ²™æ•¸èˆ¬å¤šä¸å‹æ•¸ã€‚|é€™è£¡çš„å•é¡Œæ†æ²³æ²™æ•¸ï¼Œå¤šå¾—è®“äººä¸çŸ¥å¾ä½•ä¸‹æ‰‹ã€‚
å½¢å®¹æ•¸é‡	æ˜Ÿç¾…æ£‹å¸ƒ	æ˜Ÿæ˜Ÿæ•£è½å¦‚æ£‹å­ä½ˆå±€	å½¢å®¹åˆ†å¸ƒçœ¾å¤šè€Œæœ‰ç§©åº	å¤œç©ºä¸­ç¹æ˜Ÿæ˜Ÿç¾…æ£‹å¸ƒï¼Œç¾ä¸å‹æ”¶ã€‚|é€™åº§åŸå¸‚ä¸­çš„å¤è·¡æ˜Ÿç¾…æ£‹å¸ƒï¼Œåˆ°è™•éƒ½æ˜¯æ­·å²çš„å°è¨˜ã€‚
å½¢å®¹å ´é¢	çƒ½ç«é€£å¤©	çƒ½ç«ä¿¡è™Ÿé€£æ¥å¤©éš›	å½¢å®¹æˆ°ç«é€£ç¶¿ä¸æ–·	æˆ°çˆ­æ™‚æœŸï¼Œæ•´å€‹åœ‹å®¶çƒ½ç«é€£å¤©ã€‚|æˆ°çˆ­å¹´ä»£ï¼Œçƒ½ç«é€£å¤©ï¼Œç™¾å§“ç”Ÿæ´»åœ¨æ°´æ·±ç«ç†±ä¹‹ä¸­ã€‚
å½¢å®¹å ´é¢	å“„å ‚å¤§ç¬‘	æ•´å€‹å¤§å»³éƒ½åœ¨ç¬‘	å½¢å®¹çœ¾äººå¤§ç¬‘	ä»–è¬›å®Œç¬‘è©±ï¼Œå…¨å ´é “æ™‚å“„å ‚å¤§ç¬‘ã€‚|ä»–çš„å¹½é»˜è¨€è«‡è®“å…¨å ´å“„å ‚å¤§ç¬‘ï¼Œæ°£æ°›éå¸¸è¼•é¬†æ„‰å¿«ã€‚
å½¢å®¹å ´é¢	é´‰é›€ç„¡è²	çƒé´‰å’Œéº»é›€éƒ½ä¸å‡ºè²	å½¢å®¹éå¸¸å®‰éœ	æ•™æˆä¸€é€²æ•™å®¤ï¼Œå–§é¬§çš„èª²å ‚ç«‹åˆ»é´‰é›€ç„¡è²ã€‚|æ¼”è¬›ç¾å ´é´‰é›€ç„¡è²ï¼Œå¤§å®¶éƒ½å°ˆæ³¨åœ°è½è‘—è¬›è€…çš„ç™¼è¨€ã€‚
å½¢å®¹å ´é¢	æ——é–‹å¾—å‹	æ——å¹Ÿä¸€å±•é–‹å°±ç²å‹	æ¯”å–»ä¸€é–‹å§‹å°±å–å¾—å‹åˆ©	æ¯”è³½ä¸€é–‹å§‹ï¼Œæˆ‘å€‘éšŠå°±æ——é–‹å¾—å‹ã€‚|çƒéšŠä¸€é–‹è³½ä¾¿æ——é–‹å¾—å‹ï¼Œè¿…é€Ÿå–å¾—é ˜å…ˆå„ªå‹¢ã€‚
è—è¡“è¡¨ç¾	ç²‰å¢¨ç™»å ´	åŒ–å¦å¾Œç™»å°	æ¯”å–»ç™»å°æ¼”å‡ºæˆ–å‡ºç¾åœ¨äººå€‘é¢å‰	æ–°æ¼”å“¡ç²‰å¢¨ç™»å ´ï¼Œç‚ºè©±åŠ‡å¢æ·»æ–°æ°£è±¡ã€‚|ç¶“éä¸€ç•ªæº–å‚™ï¼Œä»–å€‘çµ‚æ–¼ç²‰å¢¨ç™»å ´ï¼Œé–‹å§‹äº†ç²¾å½©çš„æ¼”å‡ºã€‚
è—è¡“è¡¨ç¾	é™½æ˜¥ç™½é›ª	æ˜¥å¤©çš„é™½å…‰å’Œç™½é›ª	å½¢å®¹é«˜é›…çš„è—è¡“	é€™é¦–äº¤éŸ¿æ¨‚å¯è¬‚é™½æ˜¥ç™½é›ªï¼Œåªæœ‰è¡Œå®¶èƒ½æ‡‚ã€‚|é€™éƒ¨ä½œå“å…§å®¹æ·±å¥§ï¼Œé¢¨æ ¼é«˜é›…ï¼Œå±¬æ–¼é™½æ˜¥ç™½é›ªä¹‹ä½œã€‚
çŸ­æš«é«”é©—	èµ°é¦¬çœ‹èŠ±	é¨é¦¬å¥”è·‘æ™‚çœ‹èŠ±	åŒ†åŒ†å¿™å¿™åœ°çœ‹ï¼Œç„¡æ³•æ·±å…¥äº†è§£	åŒ†åŒ†ä¸€å¤©çš„åŸå¸‚è§€å…‰ï¼Œåªèƒ½èµ°é¦¬çœ‹èŠ±ã€‚|ä»–é€™æ¬¡æ—…éŠæ™‚é–“å¤ªçŸ­ï¼Œåªèƒ½èµ°é¦¬çœ‹èŠ±ï¼Œæ²’èƒ½ç´°ç´°å“å‘³ç•¶åœ°é¢¨æƒ…ã€‚
çŸ­æš«é«”é©—	æµ®å…‰æ å½±	æ éçš„å…‰å½±	å½¢å®¹å°è±¡ç²—æ·º	åŒ†åŒ†ä¸€ç¥ï¼Œåªç•™ä¸‹æµ®å…‰æ å½±çš„å°è±¡ã€‚|ä»–å°é€™ä»¶äº‹æƒ…çš„ç†è§£åƒ…æ­¢æ–¼æµ®å…‰æ å½±ï¼Œä¸¦æœªæ·±å…¥æ¢è¨ã€‚
æ€§æ ¼å“è³ª	è•™è³ªè˜­å¿ƒ	è•™è‰çš„è³ªåœ°å’Œè˜­èŠ±çš„å¿ƒ	å½¢å®¹å¥³å­å“å¾·é«˜å°š	é€™ä½å¤§å®¶é–¨ç§€è•™è³ªè˜­å¿ƒï¼Œæº«å©‰å¯äººã€‚|å¥¹ä¸åƒ…å¤–è²Œå‡ºçœ¾ï¼Œé‚„æ“æœ‰è•™è³ªè˜­å¿ƒçš„å“æ ¼ï¼Œè®“äººæ¬½ä½©ã€‚
æ€§æ ¼å“è³ª	ä»å¿ƒä»è¡“	ä»æ…ˆçš„å¿ƒå’Œä»æ…ˆçš„æŠ€è¡“	å½¢å®¹é†«è€…å…·æœ‰ä»æ„›ä¹‹å¿ƒå’Œç²¾æ¹›é†«è¡“	é€™ä½é†«ç”Ÿä»å¿ƒä»è¡“ï¼Œæ·±å—ç—…æ‚£ä¿¡ä»»ã€‚|é€™ä½é†«ç”Ÿä¸åƒ…é†«è¡“é«˜æ˜ï¼Œé‚„æœ‰ä»å¿ƒä»è¡“ï¼Œæ·±å—ç—…äººæ„›æˆ´ã€‚
è™›å¹»ä¸å¯¦	é¡èŠ±æ°´æœˆ	é¡ä¸­çš„èŠ±å’Œæ°´ä¸­çš„æœˆäº®	æ¯”å–»è™›å¹»ä¸å¯¦çš„äº‹ç‰©	ä»–çš„æ‰¿è«¾å¦‚é¡èŠ±æ°´æœˆï¼Œçµ‚ç©¶æ˜¯ä¸€å ´ç©ºã€‚|é‚£äº›ç¾å¥½çš„è¨˜æ†¶ï¼Œå¦‚ä»Šå»åƒé¡èŠ±æ°´æœˆèˆ¬è™›å¹»ä¸å¯¦ã€‚
è™›å¹»ä¸å¯¦	ç©ºç©´ä¾†é¢¨	ç©ºæ´çš„æ´ç©´æœ‰é¢¨å¹ä¾†	æ¯”å–»æ²’æœ‰æ ¹æ“šçš„å‚³è¨€	é€™å€‹å‚³è¨€ä¸¦éç©ºç©´ä¾†é¢¨ï¼Œç¢ºæœ‰å…¶äº‹ã€‚|é€™äº›æµè¨€èœšèªç´”å±¬ç©ºç©´ä¾†é¢¨ï¼Œæ¯«ç„¡æ ¹æ“šã€‚
å½¢å®¹é€Ÿåº¦	å¦‚æ¹¯æ²ƒé›ª	åƒç†±æ°´æ¾†åœ¨é›ªä¸Š	å½¢å®¹å¾ˆå¿«æ¶ˆå¤±	æ”¿åºœçš„æ–°æ”¿ç­–ä¸€å‡ºï¼Œå¸‚å ´è¬ è¨€å¦‚æ¹¯æ²ƒé›ªèˆ¬æ¶ˆå¤±ã€‚|ç¶“éè€å¿ƒè§£é‡‹ï¼Œèª¤æœƒå¦‚æ¹¯æ²ƒé›ªï¼Œç¬é–“æ¶ˆå¤±ç„¡è¹¤ã€‚
å½¢å®¹é€Ÿåº¦	å”¾æ‰‹å¯å¾—	åå£æ°´å°±èƒ½å¾—åˆ°	å½¢å®¹å®¹æ˜“å¾—åˆ°	å°ä»–è€Œè¨€ï¼Œé€™ä»½å·¥ä½œå”¾æ‰‹å¯å¾—ã€‚|é€™å€‹çé …å°ä»–ä¾†èªªå¹¾ä¹æ˜¯å”¾æ‰‹å¯å¾—ï¼Œä»–çš„å¯¦åŠ›æ—©å·²å¾—åˆ°èªå¯ã€‚
å½¢å®¹æ°£å‹¢	é¤“è™æ’²é£Ÿ	é£¢é¤“çš„è€è™æ’²å‘é£Ÿç‰©	å½¢å®¹é£¢é¤“çš„è€è™æ’²é£Ÿçš„å…‡çŒ›æ¨£å­	æŠ¢è³¼æ´»å‹•ä¸€é–‹å§‹ï¼Œäººå€‘å°±åƒé¤“è™æ’²é£Ÿèˆ¬æ¹§å…¥å•†å ´ã€‚|çœ‹åˆ°ç¾å‘³ä½³é¤šï¼Œä»–å€‘åƒé¤“è™æ’²é£Ÿèˆ¬åœ°é–‹å§‹ç”¨é¤ã€‚
å½¢å®¹æ°£å‹¢	å·´è›‡åè±¡	å·´è›‡åé£Ÿå¤§è±¡	æ¯”å–»åä½µå¼·å¤§çš„å°æ‰‹	å¤§å…¬å¸å·´è›‡åè±¡èˆ¬æ”¶è³¼äº†å¤šå®¶å°ä¼æ¥­ã€‚|ä»–éæ–¼è²ªå¿ƒï¼Œåƒå·´è›‡åè±¡ï¼Œæœ€çµ‚ç„¡æ³•æ‰¿å—å¾Œæœã€‚
å½¢å®¹æ„Ÿå—	å¿ƒå¦‚æ§æœ¨	å¿ƒå¦‚æ¯æœ¨	å½¢å®¹äººéº»æœ¨ä¸ä»	å¤±å»è‡³è¦ªå¾Œï¼Œä»–æ•´å€‹äººå¿ƒå¦‚æ§æœ¨ã€‚|ç¶“æ­·é‡å¤§è®Šæ•…å¾Œï¼Œä»–å¿ƒå¦‚æ§æœ¨ï¼Œå°å‘¨åœçš„ä¸€åˆ‡éƒ½ç„¡å‹•æ–¼è¡·ã€‚
å½¢å®¹æ„Ÿå—	ç”˜æ‹œä¸‹é¢¨	ç”˜å¿ƒæ‰¿èªä¸å¦‚å°æ–¹	ç”˜é¡˜æ‰¿èªä¸å¦‚åˆ¥äºº	é¢å°å°æ‰‹çš„ç²¾æ¹›æŠ€è—ï¼Œä»–ä¸å¾—ä¸ç”˜æ‹œä¸‹é¢¨ã€‚|é¢å°å°æ‰‹çš„å‡ºè‰²è¡¨ç¾ï¼Œä»–ç”˜æ‹œä¸‹é¢¨ï¼Œå¿ƒæœå£æœã€‚
å½¢å®¹å®Œç¾	æ·‹æ¼“ç›¡è‡´	æ·‹æ¼“åˆ°äº†æ¥µè‡´	å½¢å®¹è¡¨ç¾å¾—ååˆ†å……åˆ†ã€é€å¾¹	é€™å¹…ç•«å°‡ç§‹å¤©çš„ç¾æ™¯æç¹ªå¾—æ·‹æ¼“ç›¡è‡´ã€‚|é€™å ´æ¼”å‡ºå°‡æ¯å€‹è§’è‰²çš„æƒ…æ„Ÿè¡¨ç¾å¾—æ·‹æ¼“ç›¡è‡´ï¼Œè§€çœ¾æ·±å—æ„Ÿå‹•ã€‚
å½¢å®¹å®Œç¾	å˜†ç‚ºè§€æ­¢	å˜†æ¯èªç‚ºåˆ°äº†æ¥µé™å€¼å¾—è§€çœ‹å°±æ­¢æ­¥	å½¢å®¹åˆ°äº†æ¥µé»ï¼Œå€¼å¾—è§€è³è®šå˜†	åƒè§€å®Œé€™åº§å¤è¹Ÿï¼Œå¤§å®¶éƒ½å˜†ç‚ºè§€æ­¢ã€‚|é€™åº§å¤è¹Ÿçš„å»ºç¯‰ä¹‹ç¾ï¼Œè®“æ‰€æœ‰éŠå®¢å˜†ç‚ºè§€æ­¢ã€‚
ä¸ç•¶è¡Œç‚º	æš´æ®„å¤©ç‰©	æš´æ®„ä¸Šå¤©è³œäºˆçš„ç‰©å“	ç³Ÿè¹‹ç‰©å“	æŠŠå¥½é£Ÿæåšæˆé›£åƒçš„èœï¼ŒçœŸæ˜¯æš´æ®„å¤©ç‰©ã€‚|é€™éº¼å¥½çš„é£Ÿæè¢«æµªè²»æ‰ï¼Œç°¡ç›´æ˜¯æš´æ®„å¤©ç‰©ã€‚
ä¸ç•¶è¡Œç‚º	ç‰›åˆ€å‰²é›	ç”¨æ®ºç‰›çš„åˆ€ä¾†æ®ºé›	æ¯”å–»å°é¡Œå¤§åš	æ´¾é£ç²¾è‹±åœ˜éšŠè™•ç†é€™ç¨®å°å•é¡Œï¼ŒçœŸæ˜¯ç‰›åˆ€å‰²é›ã€‚|é€™éº¼ç°¡å–®çš„å•é¡Œï¼Œç”¨ä»–ä¾†è§£æ±ºçœŸæ˜¯ç‰›åˆ€å‰²é›ï¼Œå¤§æå°ç”¨ã€‚
è¢«å‹•æ‰¿å—	æ®ƒåŠæ± é­š	ç½ç¦æ³¢åŠæ± ä¸­çš„é­š	ç„¡è¾œå—åˆ°ç‰½é€£	å…¬å¸å€’é–‰ï¼Œç„¡è¾œçš„å“¡å·¥ä¹Ÿæ®ƒåŠæ± é­šã€‚|é€™å ´èª¤æœƒæœ¬æ˜¯å°äº‹ï¼Œä½†å¾Œä¾†å»æ®ƒåŠæ± é­šï¼Œç‰½é€£äº†è¨±å¤šäººã€‚
è¢«å‹•æ‰¿å—	ç‡•é›€è™•å ‚	ç‡•å­å’Œéº»é›€ä½åœ¨å¤§å»³è£¡	æ¯”å–»èº«å±…é«˜ä½è€Œä¸è‡ªçŸ¥	ä»–çš„æ‰èƒ½è¢«åŸ‹æ²’ï¼ŒçœŸæ˜¯ç‡•é›€è™•å ‚ä¹‹é‡ã€‚|é€™éº¼å°çš„å•é¡Œå»å¼•ç™¼é€™éº¼å¤§çš„ææ…Œï¼ŒçœŸæ˜¯ç‡•é›€è™•å ‚ã€‚
æœªèƒ½å……åˆ†ç™¼æ®	æŸä¹‹é«˜é–£	æ†èµ·ä¾†æ”¾åœ¨é«˜è™•çš„é–£æ¨“ä¸Š	æŠŠäº‹ç‰©æ“±ç½®ä¸€æ—ä¸ç”¨	é€™ä»½æ”¹é©æ–¹æ¡ˆè¢«æŸä¹‹é«˜é–£ï¼Œé²é²æœªèƒ½å¯¦æ–½ã€‚|é€™é …ææ¡ˆè¢«æŸä¹‹é«˜é–£ï¼Œé²é²æœªè¢«å¯¦æ–½ã€‚
æœªèƒ½å……åˆ†ç™¼æ®	å…©è…³æ›¸æ«¥	å…©æ¢è…¿çš„æ›¸æ«ƒ	æ¯”å–»åªè®€æ›¸è€Œä¸å­¸ä»¥è‡´ç”¨çš„äºº	ä»–é›–ç„¶åšè¦½ç¾¤æ›¸ï¼Œå»æ˜¯å€‹å…©è…³æ›¸æ«¥ï¼Œä¸æ‡‚å¯¦éš›é‹ç”¨ã€‚|é€™ä½å­¸è€…åšå­¸å¤šæ‰ï¼ŒçœŸå¯è¬‚å…©è…³æ›¸æ«¥ï¼ŒçŸ¥è­˜è±å¯Œã€‚
å½¢å®¹çµæœ	è™é ­è›‡å°¾	è™é ­è›‡å°¾	é–‹å§‹è²å‹¢å¾ˆå¤§ï¼Œçµæœå»å¹³æ·¡	é€™éƒ¨é›»å½±é–‹é ­ç²¾å½©ï¼Œçµå°¾å»è™é ­è›‡å°¾ã€‚|ä»–é–‹å§‹æ™‚å……æ»¿å¹¹å‹ï¼Œä½†æœ€å¾Œå»è™é ­è›‡å°¾ï¼Œè‰è‰çµæŸã€‚
å½¢å®¹çµæœ	æ–°äº­å°æ³£	åœ¨æ–°äº­å°è‘—å“­æ³£	å½¢å®¹å®¢å±…ä»–é„‰çš„æ‚²å‚·	ä»–å€‘åœ¨ç•°é„‰ç›¸é‡ï¼Œä¸ç¦æ–°äº­å°æ³£ã€‚|ä»–å€‘åœ¨å›°å¢ƒä¸­ç›¸é‡ï¼ŒçœŸæ˜¯æ–°äº­å°æ³£ï¼Œå…±åŒæ„Ÿæ…¨å‘½é‹çš„ç„¡å¸¸ã€‚
å…¶ä»–	å‹å¸«å‹•çœ¾	å‹ç´¯è»éšŠèª¿å‹•çœ¾äºº	å½¢å®¹è€—è²»å¤§é‡äººåŠ›ç‰©åŠ›	ç‚ºäº†ä¸€ä»¶å°äº‹å‹å¸«å‹•çœ¾ï¼Œå¯¦åœ¨ä¸å€¼å¾—ã€‚|é€™å€‹å°å•é¡Œä¸å€¼å¾—å‹å¸«å‹•çœ¾ï¼Œæ‡‰è©²ç°¡å–®è™•ç†å³å¯ã€‚
å…¶ä»–	å‹ä¹‹ä¸æ­¦	å‹åˆ©å¾—ä¸å…‰å½©	å½¢å®¹å‹åˆ©ä¾†å¾—ä¸å…‰å½©	ä»¥å¼·æ¬ºå¼±ï¼Œå³ä½¿ç²å‹ä¹Ÿæœƒè®“äººè¦ºå¾—å‹ä¹‹ä¸æ­¦ã€‚|ç”±æ–¼å°æ‰‹çš„å¤±èª¤ï¼Œä»–æ‰ç²å¾—äº†å‹åˆ©ï¼Œä½†å»æ„Ÿåˆ°å‹ä¹‹ä¸æ­¦ã€‚
å…¶ä»–	èéå‰‡å–œ	è½åˆ°ééŒ¯å°±é«˜èˆˆ	æ¨‚æ–¼æ¥å—åˆ¥äººçš„æ‰¹è©•	ä¸€å€‹å„ªç§€çš„é ˜å°æ‡‰è©²èéå‰‡å–œï¼Œè™›å¿ƒæ¥å—æ‰¹è©•ã€‚|ä»–ç‚ºäººè¬™è™›ï¼Œç¸½æ˜¯èéå‰‡å–œï¼Œæ¨‚æ–¼æ¥å—åˆ¥äººçš„å»ºè­°ã€‚
å…¶ä»–	æŠ±ç—›è¥¿æ²³	æŠ±è‘—æ‚²ç—›åˆ°è¥¿æ²³	å½¢å®¹äººæ­»å¾Œçš„æ‚²ç—›	å¤±å»æ‘¯å‹ï¼Œä»–æŠ±ç—›è¥¿æ²³ï¼Œä¹…ä¹…ä¸èƒ½é‡‹æ‡·ã€‚|ä»–å› ç‚ºå¤±å»æ‘¯æ„›è€ŒæŠ±ç—›è¥¿æ²³ï¼Œé•·æœŸç„¡æ³•é‡‹æ‡·ã€‚
å…¶ä»–	å®œå®¤å®œå®¶	é©åˆæˆ¿é–“ä¹Ÿé©åˆå®¶åº­	å½¢å®¹å©¦å¥³èƒ½å¤ æŒå®¶	é€™ä½æ–°åª³å©¦ä¸åƒ…è²Œç¾ï¼Œè€Œä¸”å®œå®¤å®œå®¶ã€‚|é€™å°æ–°äººæ©æ„›å’Œç¦ï¼ŒçœŸæ˜¯å®œå®¤å®œå®¶ã€‚
`;



function removeBPMCharacters(str) {
    return str.replace(/[ó ‡ ó ‡¡ó ‡¢ó ‡£ó ‡¤ó ‡¥ó ‡¦ó ‡§ó ‡¨ó ‡©]/gu, '');
}

const idioms = idiomsData.trim().split('\n').slice(1).map(line => {
    const [åˆ†é¡, æˆèª, å­—é¢æ„æ€, è¡¨é”æ„æ€, ä¾‹å¥] = line.split('\t');
    const idiomNoBPM = removeBPMCharacters(æˆèª);
    return { åˆ†é¡, æˆèª, idiomNoBPM, å­—é¢æ„æ€, è¡¨é”æ„æ€, ä¾‹å¥ };
});

        const categories = [...new Set(idioms.map(idiom => idiom.åˆ†é¡))];
        const categorySelect = document.getElementById('category-select');
        categories.forEach(category => {
            const option = document.createElement('option');
            option.value = category;
            option.textContent = category;
            categorySelect.appendChild(option);
        });

let currentIdioms = [];
let selectedLeft = null;
let selectedRight = null;
let matchType = 'æˆèª-è¡¨é”æ„æ€';
let currentIndex = 0;
let orderedIdioms = [];
let totalRounds = 0;
let currentRound = 0;
const idiomsPerRound = 4;
let startTime;
let correctPairs = 0;
let totalPairs = 0;
let isSoundOn = true;
let currentCategoryIndex = 0;
let currentFont = 'BpmfZihiSans-Regular';
let currentFontState = 'zih';
let currentFontSize = '1.3em';

const happyEmojis = "ğŸ¥°ğŸ˜›ğŸ¤—ğŸ˜„ğŸ˜ğŸ¤©ğŸ˜˜ğŸ˜šğŸ˜‹ğŸ˜ŠğŸ˜†ğŸ˜ğŸ˜„ğŸ˜ƒ";
const sadEmojis = "ğŸ˜ŸğŸ˜®ğŸ¥ºğŸ˜§ğŸ˜¨ğŸ˜¥ğŸ˜¢ğŸ˜­ğŸ˜±ğŸ˜–ğŸ˜©ğŸ˜¤";

const rightAudio = new Audio('right.mp3');
const wrongAudio = new Audio('wrong.mp3');

function playAudio(audio) {
    if (isSoundOn) {
        audio.currentTime = 0;
        audio.play();
    }
}

document.getElementById('sound-button').onclick = toggleSound;

function toggleFont() {
    const fontToggleButton = document.getElementById('font-toggle-button');
	const ListfontToggleButton = document.getElementById('list-font-toggle-button');

    const leftItems = document.querySelectorAll('.left-item');
	const idioms = document.querySelectorAll('.idiom');

    switch(currentFontState) {
        case 'zih':
            currentFontState = 'box';
            fontToggleButton.textContent = 'æ¡†';
			ListfontToggleButton.textContent = 'æ¡†';
			currentFont = 'BpmfZihiBox-R';
			currentFontSize = '1.4em';

			leftItems.forEach(item => {
				item.style.fontFamily = 'BpmfZihiBox-R';
				item.style.fontSize = '1.4em';
			});
			idioms.forEach(item => {
				item.style.fontFamily = 'BpmfZihiBox-R';
				item.style.fontSize = '1.4em';
				item.style.minWidth = '160px';
			});
            break;
        case 'box':
            currentFontState = 'bpmf';
            fontToggleButton.textContent = 'éŸ³';
			ListfontToggleButton.textContent = 'éŸ³';
			currentFont = 'BpmfZihiOnly-R';
			currentFontSize = '2em';

			leftItems.forEach(item => {
				item.style.fontFamily = 'BpmfZihiOnly-R';
				item.style.fontSize = '2em';
			}); 
			idioms.forEach(item => {
				item.style.fontFamily = 'BpmfZihiOnly-R';
				item.style.fontSize = '1.6em';
				item.style.minWidth = '120px';
			}); 
            break;
        case 'bpmf':
            currentFontState = 'zih';
            fontToggleButton.textContent = 'å­—';
			ListfontToggleButton.textContent = 'å­—';
			currentFont = 'BpmfZihiSans-Regular';
			currentFontSize = '1.3em';

			leftItems.forEach(item => {
				item.style.fontFamily = 'BpmfZihiSans-Regular';
				item.style.fontSize = '1.3em';
			}); 
			idioms.forEach(item => {
				item.style.fontFamily = 'BpmfZihiSans-Regular';
				item.style.fontSize = '1em';
				item.style.minWidth = '120px';

			}); 
            break;
    }
}

function toggleSound() {
    isSoundOn = !isSoundOn;
    const soundButton = document.getElementById('sound-button');
    soundButton.textContent = isSoundOn ? 'ğŸ””' : 'ğŸ”•';
}

function showEndButton() {
    const endButton = document.getElementById('end-button');
    endButton.classList.add('visible');
}

function hideEndButton() {
    const endButton = document.getElementById('end-button');
    endButton.classList.remove('visible');
}

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

        function selectItem(item, side) {
            if (side === 'left') {
                if (selectedLeft) {
                    selectedLeft.classList.remove('selected');
                }
                selectedLeft = item;
            } else {
                if (selectedRight) {
                    selectedRight.classList.remove('selected');
                }
                selectedRight = item;
            }
            item.classList.add('selected');

            if (selectedLeft && selectedRight) {
                checkMatch();
            }
        }

	function stringToArray(str) {
		return Array.from(str.match(/\P{RI}\p{RI}?\p{RI}?/gu) ?? []);
	}

	function getRandomEmoji(emojiString) {
		const emojiArray = stringToArray(emojiString);
		return emojiArray[Math.floor(Math.random() * emojiArray.length)];
	}

	function changeEmoji(isCorrect) {
		const character = document.getElementById('character');
		if (isCorrect) {
			character.textContent = getRandomEmoji(happyEmojis);
			character.classList.add('animated');

			/*
			setTimeout(() => {
				character.textContent = 'ğŸ™‚';
				character.classList.remove('animated');
			}, 2000);
			*/
		} else {
			character.textContent = getRandomEmoji(sadEmojis);
			character.classList.add('animated');
		}
	}

    function checkMatch() {
        const leftText = selectedLeft.textContent;
        const rightText = selectedRight.textContent;
        const correctPair = currentIdioms.find(pair => pair.left === leftText && pair.right === rightText);

        if (correctPair) {
			correctPairs++;
			playAudio(rightAudio);
            selectedLeft.style.backgroundColor = '#4CAF50';
            selectedRight.style.backgroundColor = '#4CAF50';
            selectedLeft.style.pointerEvents = 'none';
            selectedRight.style.pointerEvents = 'none';
			selectedLeft.classList.add('correct');
			selectedRight.classList.add('correct');
            selectedLeft = null;
            selectedRight = null;
            changeEmoji(true);

            if (document.querySelectorAll('.left-item:not([style*="pointer-events: none"])').length === 0) {
				if(currentRound >= totalRounds){
					showEndButton();
				} else {
					showNextButton();
					showEndButton();
				}
            }
        } else {
			playAudio(wrongAudio);
            changeEmoji(false);
            setTimeout(() => {
                selectedLeft.classList.remove('selected');
                selectedRight.classList.remove('selected');
                selectedLeft = null;
                selectedRight = null;
            }, 500);
        }
		totalPairs++;
    }


function showResult() {
    const endTime = new Date();
    const timeSpent = Math.round((endTime - startTime) / 1000);
    const accuracy = Math.round((correctPairs / totalPairs) * 100);

    document.getElementById('accuracy-progress').style.width = `${accuracy}%`;

    document.getElementById('accuracy').textContent = `âœ¨æ­£ç¢ºï¼š${accuracy}%`;
    document.getElementById('total-rounds').textContent = `ğŸ¡å›åˆï¼š${currentRound}`;
    document.getElementById('time-spent').textContent = `â°åŠªåŠ›ï¼š${timeSpent} ç§’`;
    document.getElementById('selected-category').textContent = `ğŸ“’åˆ†é¡ï¼š${categorySelect.options[categorySelect.selectedIndex].text}`;
    document.getElementById('match-type-result').textContent = `ğŸª§é…å°ï¼š${document.getElementById('match-type-select').options[document.getElementById('match-type-select').selectedIndex].text}`;
    
    const orderSelect = document.getElementById('order-select');
    const orderText = orderSelect.options[orderSelect.selectedIndex].text;
    document.getElementById('order-type-result').textContent = `ğŸ·ï¸é †åºï¼š${orderText}`;

    document.getElementById('game').style.display = 'none';
    document.getElementById('result').style.display = 'block';
}

document.getElementById('end-button').onclick = function() {
    showResult();
};

document.getElementById('return-to-setup').onclick = function() {
    document.getElementById('result').style.display = 'none';
    resetGame();
};

        function showNextButton() {
            const nextButton = document.getElementById('next-button');
            nextButton.classList.add('visible');
        }

        function hideNextButton() {
            const nextButton = document.getElementById('next-button');
            nextButton.classList.remove('visible');
        }

function getOrderedIdioms() {
    const selectedCategory = categorySelect.value;
    return selectedCategory === 'all' ? 
        idioms.slice() : idioms.filter(idiom => idiom.åˆ†é¡ === selectedCategory);
}


function updateProgress() {
    const progress = document.getElementById('progress');
    const roundInfo = document.getElementById('round-info');
    progress.style.width = `${(currentRound / totalRounds) * 100}%`;
    roundInfo.textContent = `${currentRound}/${totalRounds}`;
}

function resetGame() {
    currentIndex = 0;
    currentRound = 0;
    orderedIdioms = [];
    correctPairs = 0;
    totalPairs = 0;
    hideEndButton();
    hideNextButton();
    document.getElementById('setup').classList.add('active');
    document.getElementById('setup').style.display = 'block';
    document.getElementById('game').classList.remove('active');
    document.getElementById('game').style.display = 'none';
}

function getRandomExample(examples) {
    const exampleArray = examples.split('|');
    return exampleArray[Math.floor(Math.random() * exampleArray.length)].trim();
}

function startNewRound() {
    const selectedCategory = categorySelect.value;
    const orderType = document.getElementById('order-select').value;

    if (currentIndex === 0 || currentIndex >= orderedIdioms.length) {
        orderedIdioms = getOrderedIdioms();
        if (orderType === 'random') {
            shuffleArray(orderedIdioms);
        }
        currentIndex = 0;
        totalRounds = Math.ceil(orderedIdioms.length / idiomsPerRound);
        currentRound = 0;
    }

    currentIdioms = [];
    for (let i = 0; i < idiomsPerRound && currentIndex < orderedIdioms.length; i++) {
        const idiom = orderedIdioms[currentIndex];
        let pair;
        switch (matchType) {
            case 'æˆèª-è¡¨é”æ„æ€':
                pair = { left: idiom.æˆèª, right: idiom.è¡¨é”æ„æ€ };
                break;
            case 'æˆèª-å­—é¢æ„æ€':
                pair = { left: idiom.æˆèª, right: idiom.å­—é¢æ„æ€ };
                break;
            case 'æˆèª-ä¾‹å¥':
                const randomExample = getRandomExample(idiom.ä¾‹å¥);
                const maskedSentence = randomExample.replace(idiom.idiomNoBPM, 'ğŸ™ˆ');
                pair = { left: idiom.æˆèª, right: maskedSentence };
                break;
        }
        currentIdioms.push(pair);
        currentIndex++;
    }

    currentRound++;
    updateProgress();

    const leftContainer = document.getElementById('leftContainer');
    const rightContainer = document.getElementById('rightContainer');

    leftContainer.innerHTML = '';
    rightContainer.innerHTML = '';


    // å‰µå»ºå·¦å´é¸é …
    const leftItems = currentIdioms.map(pair => pair.left);

    leftItems.forEach(item => {
        const leftElement = document.createElement('div');
        leftElement.className = 'left-item';
		leftElement.style.fontFamily = currentFont;
		leftElement.style.fontSize = currentFontSize;		
        leftElement.textContent = item;
        leftElement.onclick = () => selectItem(leftElement, 'left');
        leftContainer.appendChild(leftElement);
    });


    // å‰µå»ºå³å´é¸é …ï¼ˆå§‹çµ‚éš¨æ©Ÿæ’åºï¼‰
    const rightItems = currentIdioms.map(pair => pair.right);
    shuffleArray(rightItems);
    rightItems.forEach(item => {
        const rightElement = document.createElement('div');
        rightElement.className = 'right-item';
        rightElement.textContent = item;
        rightElement.onclick = () => selectItem(rightElement, 'right');
        rightContainer.appendChild(rightElement);
    });

    if (currentRound === 1) {
        startTime = new Date();
    }

}






        document.getElementById('next-button').onclick = function() {
            hideNextButton();
			hideEndButton();
            startNewRound();
        };

document.getElementById('start-button').onclick = function() {
    matchType = document.getElementById('match-type-select').value;
    document.getElementById('setup').classList.remove('active');
    document.getElementById('setup').style.display = 'none';
    document.getElementById('game').classList.add('active');
    document.getElementById('game').style.display = 'block';

    currentIndex = 0;
    currentRound = 0;
    orderedIdioms = [];
    startNewRound();
};

document.getElementById('close-button').onclick = function() {
    resetGame();
};



document.getElementById('view-idioms-button').onclick = function() {//here
	currentFont = 'BpmfZihiSans-Regular';
	currentFontState = 'zih';
	currentFontSize = '1.3em';
    const fontToggleButton = document.getElementById('font-toggle-button');
	const ListfontToggleButton = document.getElementById('list-font-toggle-button');
	fontToggleButton.textContent = 'å­—';
	ListfontToggleButton.textContent = 'å­—';
    document.getElementById('setup').style.display = 'none';
    document.getElementById('idiom-list').style.display = 'block';
    renderIdiomList(); 
};

document.getElementById('close-idiom-list').onclick = function() {
    document.getElementById('idiom-list').style.display = 'none';
    document.getElementById('setup').style.display = 'block';
};



function replaceIdiomWithUnderscore(sentence, idiom) {
    return sentence.replace(new RegExp(idiom, 'g'), 'ğŸ™ˆ');
}

function renderIdiomList() {
    const selectedCategory = document.getElementById('category-select').value;
    const table = document.getElementById('idiom-table');
    const tbody = table.querySelector('tbody');
    tbody.innerHTML = '';

    // ç¯©é¸æˆèª
    const filteredIdioms = selectedCategory === 'all' 
        ? idioms 
        : idioms.filter(idiom => idiom.åˆ†é¡ === selectedCategory);

    filteredIdioms.forEach((idiom, index) => {
        const randomExample = getRandomExample(idiom.ä¾‹å¥);
        const row = document.createElement('tr');
        row.innerHTML = `
            <td class="category"><small>${idiom.åˆ†é¡}</small></td>
            <td><small class="small-number">${index + 1} </small><span class="idiom">${idiom.æˆèª}</span></td>
            <td class="literal">${idiom.å­—é¢æ„æ€}</td>
            <td class="figurative">${idiom.è¡¨é”æ„æ€}</td>
            <td class="example">${replaceIdiomWithUnderscore(randomExample, idiom.idiomNoBPM)}</td>
        `;
        tbody.appendChild(row);
    });

	const idiomList = document.querySelectorAll('.idiom');
    idiomList.forEach(item => {
		item.style.fontFamily = currentFont;
    });

    updateVisibility();
    updateCategoryNavigation();
}

function updateVisibility() {
    const showCategory = document.getElementById('show-category').checked;
    const showIdiom = document.getElementById('show-idiom').checked;
    const showLiteral = document.getElementById('show-literal').checked;
    const showFigurative = document.getElementById('show-figurative').checked;
    const showExample = document.getElementById('show-example').checked;

    document.querySelectorAll('#idiom-table .category').forEach(el => el.style.display = showCategory ? '' : 'none');
    document.querySelectorAll('#idiom-table .idiom').forEach(el => el.style.display = showIdiom ? '' : 'none');
    document.querySelectorAll('#idiom-table .literal').forEach(el => el.style.display = showLiteral ? '' : 'none');
    document.querySelectorAll('#idiom-table .figurative').forEach(el => el.style.display = showFigurative ? '' : 'none');
    document.querySelectorAll('#idiom-table .example').forEach(el => el.style.display = showExample ? '' : 'none');
}

document.querySelectorAll('.idiom-controls input[type="checkbox"]').forEach(checkbox => {
    checkbox.addEventListener('change', updateVisibility);
});

document.getElementById('category-select').addEventListener('change', function() {
    renderIdiomList();
    updateCategoryNavigation();
});

function updateCategoryNavigation() {
    const categorySelect = document.getElementById('category-select');
    const prevButton = document.getElementById('prev-category');
    const nextButton = document.getElementById('next-category');
    const categories = Array.from(categorySelect.options).map(option => option.value);
    currentCategoryIndex = categories.indexOf(categorySelect.value);

    prevButton.disabled = currentCategoryIndex <= 1;  // ç¦ç”¨"å…¨éƒ¨"çš„ä¸Šä¸€å€‹
    nextButton.disabled = currentCategoryIndex >= categories.length - 1;

    if (currentCategoryIndex > 0) {
        prevButton.textContent = "< "  + categories[currentCategoryIndex - 1];
    }
    if (currentCategoryIndex < categories.length - 1) {
        nextButton.textContent = categories[currentCategoryIndex + 1] + " >";
    }

    // å¦‚æœé¸æ“‡çš„æ˜¯"å…¨éƒ¨"ï¼Œéš±è—å°èˆªæŒ‰éˆ•
    const navigationDiv = document.querySelector('.category-navigation');
    navigationDiv.style.display = categorySelect.value === 'all' ? 'none' : 'flex';
}

function changeCategory(direction) {
    const categorySelect = document.getElementById('category-select');
    const categories = Array.from(categorySelect.options).map(option => option.value);
    
    currentCategoryIndex += direction;
    if (currentCategoryIndex < 1) currentCategoryIndex = 1;  // ä¸è¦é¸åˆ°"å…¨éƒ¨"
    if (currentCategoryIndex >= categories.length) currentCategoryIndex = categories.length - 1;

    categorySelect.value = categories[currentCategoryIndex];
    renderIdiomList();
    updateCategoryNavigation();
}

document.getElementById('prev-category').onclick = () => changeCategory(-1);
document.getElementById('next-category').onclick = () => changeCategory(1);

updateCategoryNavigation();

document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('font-toggle-button').addEventListener('click', toggleFont);
	document.getElementById('list-font-toggle-button').addEventListener('click', toggleFont);	
});

    </script>
</body>
</html>
