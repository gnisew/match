<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🥷烏衣行成語</title>
	<link rel="stylesheet" href="https://oikasu1.github.io/fonts/twfonts.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
			user-select: none;
        }
        .container {
            background-color: white;
	  	    justify-content: center;
		    align-items: center;
            padding: 30px 20px 20px 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 800px;
            width: 100%;
        }
        .setup, .game {
            display: none;
        }
        .active {
            display: block;
        }
        select, button {
            margin: 10px;
            padding: 5px 10px;
        }
        .item-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 20px;
        }
        .left-item, .right-item {
            margin: 5px;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
			border: 2px solid #fff;			
        }

        .left-item:hover, .right-item:hover {
            background-color: #c0f0c0;
        }

        .left-item {
			background-color: #f3f3f3;
			font-family: BpmfZihiSans-Regular;	
			font-size: 1.3em;
        }

        .right-item {
			background-color: #eaeaea;
        }

        .selected {
            background-color: #4CAF50;
            color: white;
        }

        .selected:hover {
            background-color: #299920;
            color: white;
        }

		.left-item.correct, .right-item.correct {
			background-color: #fff !important;
			color: #1B5E20;
			border: 2px solid #AACC88;
		}

        #start-button, #view-idioms-button {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

		#next-button-container {
			display: flex;
			justify-content: space-between;
			margin-top: 10px;
		}
		#next-button, #end-button {
			width: calc(50% - 5px);
			height: 40px;
			padding: 10px;
			background-color: #4CAF50;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			visibility: hidden;
			opacity: 0;
			transition: opacity 0.3s ease;
		}

		#next-button.visible, #end-button.visible {
			visibility: visible;
			opacity: 1;
		}



		#return-to-setup {
			display: block;
			margin-top: 20px;
			padding: 10px 20px;
			background-color: #4CAF50;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
		}
        .progress-container {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .close-button {
            margin-right: 40px;
            cursor: pointer;
            font-size: 20px;
        }

        .progress-bar {
            flex-grow: 1;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }
        .progress {
            height: 100%;
            background-color: orange;
            width: 0%;
            transition: width 0.3s ease;
        }
        .round-info {
            margin-left: 10px;
            font-weight: bold;
        }
        #character {
		font-size: 1.5em;
            transition: transform 0.3s ease;
        }
        #character.animated {
            transform: scale(1.5);
        }

		.result {
			display: none;
	  	    justify-content: center;
		    align-items: center;
			margin: 20px auto;
			max-width: 400px;
			padding: 20px;
			border-radius: 10px;

		}

		.result h2 {
			text-align: center;
			margin-bottom: 20px;
			color: #333;
		}

		.result p {
			margin: 10px 0;
			font-size: 16px;
			color: #555;
		}

		.accuracy-container {
		 text-align: center;
		}

		.accuracy-bar {
			flex-grow: 1;
			height: 20px;
			background-color: #e0e0e0;
			border-radius: 10px;
			margin-left: 10px;
			overflow: hidden;
		}

		#accuracy-progress {
			height: 100%;
			background-color: orange;
			width: 0%;
			transition: width 0.5s ease-in-out;
		}

		#return-to-setup {
			display: block;
			width: 100%;
			margin-top: 20px;
			padding: 10px;
			background-color: #4CAF50;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			font-size: 16px;
			transition: background-color 0.3s;
		}

		#return-to-setup:hover {
			background-color: #45a049;
		}

		@media (max-width: 768px) {
			.right-item {
				margin-top: 10px;
				margin-bottom: 10px;
			}
		}

		@media (max-width: 768px) {
			.game {
				height: 90vh;
				overflow-y: auto;
				scrollbar-width: none;
				-ms-overflow-style: none;
			}

			.game::-webkit-scrollbar {
				display: none;
			}
		}

		@media (max-width: 768px) {
			.item-container {
				flex-direction: column;
				align-items: stretch;
			}

			#leftContainer {
				flex-direction: row;
				flex-wrap: wrap;
				justify-content: space-between;
			}

			#leftContainer .left-item {
				width: calc(50% - 10px);
				box-sizing: border-box;\				
			}

			#rightContainer .right-item {
				width: calc(100% - 30px);
				margin-bottom: 10px;
			}

			#next-button-container {
				flex-direction: row;
			}

			#next-button, #end-button {
				width: calc(50% - 5px);
			}


		}

		.sound-button {

			margin: 0px 5px;
			cursor: pointer;
			font-size: 20px;
		}

.idiom-list {
    background-color: white;
    padding: 10px 20px;
    border-radius: 10px;
    width: calc(100% - 40px);
    margin: 0 auto;
	height: 70vh;
    position: relative;
}

.idiom-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    position: relative;
}

.idiom-header h2 {
    margin: 0;
    flex-grow: 1;
    text-align: center;
}

.idiom-header .close-button {
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    font-size: 1.5em;
    cursor: pointer;
    padding: 0;
}

.list-close-button {
    background: none;
    border: none;
    font-size: 1.2em;
    cursor: pointer;
    padding: 0;
}

/* 確保其他關閉按鈕不受影響 */
.close-button:not(#close-idiom-list) {
    position: static;
    transform: none;
}





.close-button {
    background: none;
    border: none;
    font-size: 1.5em;
    cursor: pointer;
    color: #333;
}

.idiom-controls {
    margin-bottom: 10px;
}

.idiom-controls label {
    margin-right: 10px;
}




.idiom-table-container {
    overflow-x: auto;
    max-height: calc(80vh - 130px);
}

#idiom-table {
    width: 100%;
    border-collapse: collapse;
}

#idiom-table thead {
    position: sticky;
    top: 0;
	padding: 20px;
    background-color: #f2f2f2;
    z-index: 1;
}

#idiom-table th  {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: center;
}

#idiom-table td {
    border: 1px solid #ddd;
    padding: 5px 5px 5px 10px;
    text-align: left;
}



.small-number{
    color: #ff5555;
	font-size: 0.4em;
}

.idiom {
    min-width: 130px;
	font-size: 1.1em;
	font-family: BpmfZihiSans-Regular;
}




#idiom-table th {
    background-color: #e1e1e1;
}

#idiom-table tbody tr:nth-child(odd) {
    background-color: #f8f8f8;
}

#idiom-table tbody tr:nth-child(even) {
    background-color: #fefefe;
}

@media (max-width: 768px) {
    .idiom-list {
        padding: 10px;
        max-height: 90vh;
    }

    .idiom-controls {
        display: flex;
        flex-wrap: wrap;
    }

    .idiom-controls label {
        margin-bottom: 10px;
    }

    #idiom-table {
        font-size: 14px;
    }
    
    #idiom-table th, #idiom-table td {
        padding: 5px;
    }
}

.nav-button {
    padding: 5px 10px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
}

.nav-button:hover {
    background-color: #45a049;
}

.nav-button:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
}
.font-toggle-button {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    border: 1px solid #4CAF50;
    background-color: white;
    color: #4CAF50;
    font-size: 12px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    margin-right: 5px;
}

#clear-records {
    background-color: #f44336;
    color: white;
    border: none;
    padding: 5px 10px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 12px;
    margin: 10px 5px 0 5px;
    cursor: pointer;
    border-radius: 50px;
    transition: background-color 0.3s;
}

#clear-records:hover {
    background-color: #d32f2f;
}

#clear-records:active {
    background-color: #b71c1c;
}

#clear-records:disabled {
    background-color: #cccccc;
    color: #666666;
    cursor: not-allowed;
}

.sorting-area {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 20px 0;
}

.answer-area {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    min-height: 65px;
    border-bottom: 2px solid #333;
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
}


.character-options {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-bottom: 10px;
}

.character-option, .in-answer {
    font-size: 1.2em;
    margin: 5px;
    padding: 8px;
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    border-radius: 5px;
    cursor: pointer;
}

.check-button {
    margin-top: 10px;
    padding: 10px 20px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
}

.check-button:disabled {
    background-color: #cccccc;
    color: #666666;

}

.idiom-question {
    margin-bottom: 20px;
    font-weight: bold;
}



.character-option:hover, .in-answer:hover {
    background-color: #e0e0e0;
}



.in-answer {
    font-size: 1.5em;
    margin: 5px;
    padding: 10px;
    background-color: #e0f0e0;
    border: 1px solid #ccc;
    border-radius: 5px;
    cursor: pointer;
    display: inline-block;
}
    </style>
</head>
<body>
    <div class="container">
		<div class="setup active" id="setup">
			<h1 id="myTitle">🥷烏衣行成語</h1>
			<div>
				<label for="category-select">分類：</label>
				<select id="category-select">
					<option value="all">所有分類</option>
					<!-- 其他分類選項將在這裡動態生成 -->
				</select>
			</div>
			<div>
				<label for="match-type-select">配對：</label>
				<select id="match-type-select">
					<option value="成語-表達意思">成語 - 表達意思</option>
					<option value="成語-字面意思">成語 - 字面意思</option>
					<option value="成語-例句">成語 - 例句</option>
					<option value="成語-排序">成語 - 排序</option>
				</select>
			</div>
			<div>
				<label for="order-select">順序：</label>
				<select id="order-select">
					<option value="random">隨機</option>
					<option value="sequential">依序</option>
				</select>
			</div>			
			<button id="view-idioms-button">檢視成語 🔎</button>
			<button id="start-button">開始遊戲 🚀</button>
		</div>

		<div class="game" id="game">
			<div class="progress-container">
				<div class="close-button" id="close-button">✖︎</div>				
				<div class="progress-bar">
					<div class="progress" id="progress"></div>
				</div>
				<div class="round-info" id="round-info"></div>
				<div class="sound-button" id="sound-button">🔔</div>
				<div class="font-toggle-button" id="font-toggle-button">字</div>
			</div>
			<h1><span id="character">🙂</span></h1>
			<div id="left-right-container">
				<div class="item-container" id="leftContainer"></div>
				<div class="item-container" id="rightContainer"></div>
			</div>
			<div id="sorting-container" style="display: none;">
				<div class="idiom-question" id="idiom-question"></div>
				<div class="sorting-area">
					<div id="answer-area" class="answer-area"></div>
					<div id="character-options" class="character-options"></div>
				</div>
				<button id="check-answer" class="check-button">確定</button>
			</div>
			<div id="next-button-container">                
				<button id="end-button">🎉 結束</button>
				<button id="next-button">下一題 🚀</button>
			</div>
		</div>

		<div class="idiom-list" id="idiom-list" style="display: none;">
			<div class="idiom-header">
			<button id="close-idiom-list" class="list-close-button">✖︎</button><button id="prev-category" class="nav-button">上一分類</button>
				<h2>🥷成語</h2>
				
				<button id="next-category" class="nav-button">下一分類</button><div class="font-toggle-button" id="list-font-toggle-button">字</div>
			</div>

			<div class="idiom-controls">
				<label><input type="checkbox" id="show-category" checked>分類</label>
				<label><input type="checkbox" id="show-idiom" checked>成語</label>
				<label><input type="checkbox" id="show-literal" checked>字面</label>
				<label><input type="checkbox" id="show-figurative" checked>用意</label>
				<label><input type="checkbox" id="show-example">例句</label>
			</div>
			<div class="idiom-table-container">
				<table id="idiom-table">
					<thead>
						<tr>
							<th class="category">分類</th>
							<th class="idiom">成語</th>
							<th class="literal">字面意思</th>
							<th class="figurative">表達意思</th>
							<th class="example">例句</th>
						</tr>
					</thead>
					<tbody>
						<!-- 成語資料將在這裡動態生成 -->
					</tbody>
				</table>
			</div>
		</div>

		<div id="result" class="result">
			<h2>🥷烏衣行成語</h2>
		
				<div class="accuracy-bar">
					<div id="accuracy-progress"></div>
				</div>

			<div class="accuracy-container">		
				<p id="accuracy"></p>
				<p id="time-spent"></p>
				<p id="total-rounds"></p>
				<p id="total-pairs"></p>
				<p id="selected-category"></p>
				<p id="match-type-result"></p>
				<p id="order-type-result"></p>
			</div>
			<button id="clear-records" disabled>清除紀錄 🗑️</button>
			<button id="return-to-setup">返回 🛸</button>
		</div>

    </div>

    <script>
        const idiomsData = `
分類	成語	字面意思	表達意思	例句	拼音
01 才能與智慧	才高八斗	才能高達八斗之多	形容才學極為優秀	這位年輕作家才高八斗，作品備受讚譽。|這位作家才高八斗，作品廣受好評，文名遠揚。	cai2 gao1 ba1 dou3
01 才能與智慧	見微知著󠇡	看到微小就知道顯著的	從細微處見識到事物的本質	優秀的管理者能夠見微知著，防患於未然。|從一點小事中，他見微知著，預見了後續發展的趨勢。	jian4 wei1 zhi1 zhuo2
01 才能與智慧	名副其實	名稱符合實際	名稱與實際相符合	這家餐廳的招牌菜名副其實，味道確實一流。|這家餐廳的美食確實名副其實，值得一試。	ming2 fu4 qi2 shi2
01 才能與智慧	水到渠成	水來了，渠道就成形了	事情水到渠成，順利成功	只要努力，成功自然水到渠成。|經過長期的準備，項目最終順利完成，真是水到渠成。	shui3 dao4 qu2 cheng2
02 勤奮與毅力	汲汲營營	急切地營求	形容急於追求	他整天汲汲營營於事業，卻忽視了家庭。|他汲汲營營地追求名利，卻忽略了生活中的真正價值。	ji2 ji2 ying2 ying2
02 勤奮與毅力	百折不撓	百次挫折也不屈服	屢遇挫折而不屈服	她面對挫折百折不撓，最終成功創業。|面對多次挫折，他依然百折不撓，最終取得了成功。	bai3 zhe2 bu4 nao2
02 勤奮與毅力	疾風勁草	強風中的勁草	比喻在逆境中堅強不屈的人	面對困境，他如疾風勁草，愈挫愈勇。|在疾風勁草的考驗下，真正的英雄才能脫穎而出。	ji2 feng1 jing4 cao3
02 勤奮與毅力	孜孜不󠇡倦	勤勉不疲倦	勤奮不懈	科學家們孜孜不倦地研究，終於取得重大突破。|他孜孜不倦地追求真理，不斷探索新的知識領域。	zi1 zi1 bu4 juan4
02 勤奮與毅力	手不󠇡釋卷	手不釋放書卷	形容勤奮好學	她求學時期手不釋卷，最終考上了理想的大學。|他為了考試，日夜苦讀，手不釋卷，最終取得了好成績。	shou3 bu4 shi4 juan4
03 情感與心理狀態	鶼鰈情深	夫妻像鶼鳥形影不離，像鰈魚成雙游動	比喻夫妻恩愛	這對老夫妻鶼鰈情深，令人羨慕。|他們夫妻倆鶼鰈情深，讓人十分羨慕。	jian1 die2 qing2 shen1
03 情感與心理狀態	新亭對泣	在新亭對著哭泣	形容客居他鄉的悲傷	他們在異鄉相遇，不禁新亭對泣。|他們在困境中相遇，真是新亭對泣，共同感慨命運的無常。	xin1 ting2 dui4 qi4
03 情感與心理狀態	心如槁木	心麻木如枯槁的木	形容人麻木不仁	失去至親後，他整個人心如槁木。|經歷重大變故後，他心如槁木，對周圍的一切都無動於衷。	xin1 ru2 gao3 mu4
03 情感與心理狀態	言猶在耳	言說的話還在耳邊	剛說過的話還在耳邊回響	父親的教誨言猶在耳，指引著我的人生方向。|老師的教誨言猶在耳，他始終銘記在心。	yan2 you2 zai4 er3
03 情感與心理狀態	抱痛西河	抱著悲痛到西河	形容人死後的悲痛	失去摯友，他抱痛西河，久久不能釋懷。|他因為失去摯愛而抱痛西河，長期無法釋懷。	bao4 tong4 xi1 he2
03 情感與心理狀態	蕙質蘭心	高尚如蕙草的質地和蘭花的心	形容女子品德高尚	這位大家閨秀蕙質蘭心，溫婉可人。|她不僅外貌出眾，還擁有蕙質蘭心的品格，讓人欽佩。	hui4 zhi4 lan2 xin1
03 情感與心理狀態	毛骨悚然	毛髮和骨頭都豎起來了	形容非常害怕的樣子	聽到深夜的詭異聲響，我感到毛骨悚然。|聽到那恐怖的故事，他不禁毛骨悚然，汗毛豎起。	mao2 gu3 song3 ran2
03 情感與心理狀態	涕泗滂沱	鼻涕眼淚如滂沱大雨	形容痛哭流涕的樣子	得知噩耗，她涕泗滂沱，久久不能平復。|聽到那悲慘的故事，她忍不住涕泗滂沱，淚流滿面。	ti4 si4 pang1 tuo2
03 情感與心理狀態	悵然若失	失落得好像丟失了東西	形容失意或失望的樣子	畢業典禮後，同學們都感到悵然若失。|離開熟悉的環境，他感到悵然若失，心裡空落落的。	chang4 ran2 ruo4 shi1
04 處境與環境	烽火連天	烽火信號連接天際	形容戰火連綿不斷	戰爭時期，整個國家烽火連天。|戰爭年代，烽火連天，百姓生活在水深火熱之中。	feng1 huo3 lian2 tian1
04 處境與環境	四面楚歌	間難如四面都是楚國的歌聲	比喻四面受敵，處境困難	公司陷入困境，面臨四面楚歌的局面。|公司內外問題重重，四面楚歌，陷入了困境。	si4 mian4 chu3 ge1
04 處境與環境	顛沛流離	顛簸奔波流落他鄉	形容生活動盪不安	戰亂時期，百姓顛沛流離，生活艱難。|戰爭讓許多家庭顛沛流離，生活困苦不堪。	dian1 pei4 liu2 li2
04 處境與環境	殃及池魚	災殃波及池中的魚	無辜受到牽連	公司倒閉，無辜的員工也殃及池魚。|這場誤會本是小事，但後來卻殃及池魚，牽連了許多人。	yang1 ji2 chi2 yu2
04 處境與環境	燕雀處堂	燕子和麻雀住在大廳裡	比喻身居高位而不自知	他的才能被埋沒，真是燕雀處堂之遇。|這麼小的問題卻引發這麼大的恐慌，真是燕雀處堂。	yan4 que4 chu3 tang2
04 處境與環境	陽春白雪	高雅如春天陽光和白雪	形容高雅的藝術	這首交響樂可謂陽春白雪，只有行家能懂。|這部作品內容深奧，風格高雅，屬於陽春白雪之作。	yang2 chun1 bai2 xue3
05 行為與態度	同舟共濟	同坐一條船，共同渡河	比喻同心協力，共渡難關	在困難時期，全體員工同舟共濟，共度難關。|面對困難，大家必須同舟共濟，才能度過難關。	tong2 zhou1 gong4 ji4
05 行為與態度	甘拜下風	甘心承認居對方之下風	甘願承認不如別人	面對對手的精湛技藝，他不得不甘拜下風。|面對對手的出色表現，他甘拜下風，心服口服。	gan1 bai4 xia4 feng1
05 行為與態度	宜室宜家	適合房間也適合家庭	形容婦女能夠持家	這位新媳婦不僅貌美，而且宜室宜家。|這對新人恩愛和睦，真是宜室宜家。	yi2 shi4 yi2 jia1
05 行為與態度	聞過則喜	聽到過錯就歡喜	樂於接受別人的批評	一個優秀的領導應該聞過則喜，虛心接受批評。|他為人謙虛，總是聞過則喜，樂於接受別人的建議。	wen2 guo4 ze2 xi3
05 行為與態度	好󠇡逸惡󠇡勞	喜好安逸，厭惡勞動	貪圖安逸，討厭勞動	他整天躺在沙發上看電視，真是好逸惡勞。|他好逸惡勞，不願努力工作，生活自然不會順利。	hao4 yi4 wu4 lao2
05 行為與態度	仁心仁術	仁慈的心腸和仁愛的技術	形容既具同情心又有高超技術的人，特別指醫生	那位醫生不僅醫術精湛，還對病人特別關懷，真是仁心仁術的典範。|在災區，他們展現出仁心仁術，無私地救助每一位需要幫助的人。	ren2 xin1 ren2 shu4
05 行為與態度	甘之如飴	甘甜如糖飴	把苦事當作甜事來做	他對繁重的工作甘之如飴，從不抱怨。|雖然工作艱辛，但他甘之如飴，樂在其中。	gan1 zhi1 ru2 yi2
06 策略與方法	破釜沉舟	打破鍋釜，沉沒船隻	比喻下定決心，不留退路	軍隊破釜沉舟，展現必勝的決心。|他下定決心，破釜沉舟，一定要完成這個項目。	po4 fu3 chen2 zhou1
06 策略與方法	亡羊補牢	失去羊後修補羊圈	亡羊後補牢，亡羊後補牢，為時未晚	這次失誤後，公司立即採取措施，可謂亡羊補牢。|雖然錯過了最佳時機，但他還是趕緊亡羊補牢，避免更大的損失。	wang2 yang2 bu3 lao2
06 策略與方法	因材施教	根據才能施行教育	根據不同的人因材施教	好老師都懂得因材施教，讓每個學生都能發揮所長。|老師根據學生的不同特點因材施教，取得了良好的教學效果。	yin1 cai2 shi1 jiao4
06 策略與方法	逆水行舟	逆著水流划行舟船	比喻學習要不斷努力	創業維艱，如同逆水行舟，不進則退。|學習如同逆水行舟，不進則退，必須不斷努力。	ni4 shui3 xing2 zhou1
07 形容做事風格	牛刀割雞	用殺牛的刀來殺雞	比喻小題大做	派遣精英團隊處理這種小問題，真是牛刀割雞。|這麼簡單的問題，用他來解決真是牛刀割雞，大材小用。	niu2 dao1 ge1 ji1
07 形容做事風格	束之高閣	捆束起來放在閣樓高處	把事物擱置一旁不用	這份改革方案被束之高閣，遲遲未能實施。|這項提案被束之高閣，遲遲未被實施。	shu4 zhi1 gao1 ge2
07 形容做事風格	唾手可得	吐口水就能得到	形容容易得到	對他而言，這份工作唾手可得。|這個獎項對他來說幾乎是唾手可得，他的實力早已得到認可。	tuo4 shou3 ke3 de2
07 形容做事風格	虎頭蛇尾	開始如虎頭大，結束像蛇尾小	開始聲勢很大，結果卻平淡	這部電影開頭精彩，結尾卻虎頭蛇尾。|他開始時充滿幹勁，但最後卻虎頭蛇尾，草草結束。	hu3 tou2 she2 wei3
07 形容做事風格	勞師動眾	勞累軍隊，調動眾人	形容耗費大量人力物力	為了一件小事勞師動眾，實在不值得。|這個小問題不值得勞師動眾，應該簡單處理即可。	lao2 shi1 dong4 zhong4
07 形容做事風格	走馬看花	騎馬奔跑時看花	匆匆忙忙地看，無法深入了解	匆匆一天的城市觀光，只能走馬看花。|他這次旅遊時間太短，只能走馬看花，沒能細細品味當地風情。	zou3 ma3 kan4 hua1
07 形容做事風格	浮光掠影	浮在水面的光，掠過的影子	形容印象粗淺	匆匆一瞥，只留下浮光掠影的印象。|他對這件事情的理解僅止於浮光掠影，並未深入探討。	fu2 guang1 lüe4 ying3
07 形容做事風格	囫圇吞棗	整顆吞下棗子	學習不求甚解	考試前急於複習的學生往往囫圇吞棗，效果不佳。|學習知識不能囫圇吞棗，應該細細品味，深入理解。	hu2 lun2 tun1 zao3
07 形容做事風格	箭在弦上	緊急如箭已經搭在弦上了	事情已到緊要關頭	計劃已經成熟，箭在弦上，不得不發。|事情已經發展到這種地步，簡直是箭在弦上，不得不發。	jian4 zai4 xian2 shang4
07 形容做事風格	單刀直入	單把刀直接進入	直截了當地說明來意	他單刀直入地指出了問題的癥結。|他在會議中單刀直入，直接提出了問題的關鍵所在。	dan1 dao1 zhi2 ru4
08 人際關係	管鮑之交	管仲和鮑叔有好的交情	形容朋友之間非常要好	他們倆可謂管鮑之交，情誼深厚。|他們兩人的友誼深厚，堪稱現代的管鮑之交。	guan3 bao4 zhi1 jiao1
08 人際關係	勝之不武	勝利得不光彩	形容勝利來得不光彩	以強欺弱，即使獲勝也會讓人覺得勝之不武。|由於對手的失誤，他才獲得了勝利，但卻感到勝之不武。	sheng4 zhi1 bu4 wu3
08 人際關係	平分秋色	平均分配秋天的景色	勢均力敵，不相上下	兩支球隊實力相當，比賽結果平分秋色。|兩隊實力相當，這場比賽最終平分秋色，難分高下。	ping2 fen1 qiu1 se4
08 人際關係	狐假虎威	狐狸假借老虎的威風	仗勢欺人	仗著上司的權勢，他經常狐假虎威。|那個小主管狐假虎威，仗勢欺人，讓人十分反感。	hu2 jia3 hu3 wei1
08 人際關係	落井下石	向掉進井裡的人扔下石頭	趁人處於困境落井下石	朋友遭遇困境，我們應該伸出援手，而不是落井下石。|他在朋友困難時不僅沒有幫助，反而落井下石，讓人心寒。	luo4 jing3 xia4 shi2
08 人際關係	暗箭傷人	暗中射箭傷人	暗中傷害他人	職場中暗箭傷人的事時有發生，要多加小心。|他在背後散播流言，暗箭傷人，讓人無法防備。	an4 jian4 shang1 ren2
08 人際關係	伯樂相馬	伯樂很擅長於相好馬	善於發現人才	這位星探善於伯樂相馬，發掘了許多演藝新秀。|在他的推薦下，那位新人得到了重用，真是伯樂相馬。	bo2 le4 xiang1 ma3
08 人際關係	雀屏中選	麻雀在屏風中被選中	在眾多競爭者中脫穎而出	在激烈的競爭中，他雀屏中選，成功晉級。|在眾多應聘者中，他憑藉出色的表現雀屏中選，獲得了這份工作。	que4 ping2 zhong1 xuan3
09 描述場面或氛圍	嘆為觀止	嘆息認為到了極限值得觀看就止步	形容到了極點，值得觀賞讚嘆	參觀完這座古蹟，大家都嘆為觀止。|這座古蹟的建築之美，讓所有遊客嘆為觀止。	tan4 wei2 guan1 zhi3
09 描述場面或氛圍	淋漓盡致	淋漓到了極致	形容表現得十分充分、透徹	這幅畫將秋天的美景描繪得淋漓盡致。|這場演出將每個角色的情感表現得淋漓盡致，觀眾深受感動。	lin2 li2 jin4 zhi4
09 描述場面或氛圍	哄堂大笑	整個大廳都在笑	形容眾人大笑	他講完笑話，全場頓時哄堂大笑。|他的幽默言談讓全場哄堂大笑，氣氛非常輕鬆愉快。	hong1 tang2 da4 xiao4
09 描述場面或氛圍	鴉雀無聲	烏鴉和麻雀都不出聲	形容非常安靜	教授一進教室，喧鬧的課堂立刻鴉雀無聲。|演講現場鴉雀無聲，大家都專注地聽著講者的發言。	ya1 que4 wu2 sheng1
09 描述場面或氛圍	旗開得勝	旗幟一展開就獲勝	比喻一開始就取得勝利	比賽一開始，我們隊就旗開得勝。|球隊一開賽便旗開得勝，迅速取得領先優勢。	qi2 kai1 de2 sheng4
09 描述場面或氛圍	拍案叫絕	拍桌子叫絕妙	形容十分讚賞	聽完他的提案，與會者都拍案叫絕。|他的演技令人驚嘆，觀眾不禁拍案叫絕。	pai1 an4 jiao4 jue2
09 描述場面或氛圍	談笑風生	談笑中風趣橫生	談吐自如，說話有趣	酒過三巡，眾人談笑風生，其樂融融。|聚會上大家談笑風生，氣氛相當愉快。	tan2 xiao4 feng1 sheng1
09 描述場面或氛圍	粉墨登場	擦粉畫線後，登場演出	比喻登台演出或出現在人們面前	新演員粉墨登場，為話劇增添新氣象。|經過一番準備，他們終於粉墨登場，開始了精彩的演出。	fen3 mo4 deng1 chang3
10 比喻與誇張	餓虎撲食	飢餓的老虎撲向食物	形容飢餓的老虎撲食的兇猛樣子	抢購活動一開始，人們就像餓虎撲食般湧入商場。|看到美味佳餚，他們像餓虎撲食般地開始用餐。	e4 hu3 pu1 shi2
10 比喻與誇張	巴蛇吞象	小隻巴蛇吞食大象	比喻吞併強大的對手	大公司巴蛇吞象般收購了多家小企業。|他過於貪心，像巴蛇吞象，最終無法承受後果。	ba1 she2 tun1 xiang4
10 比喻與誇張	如湯沃雪	像熱湯水澆在雪上	形容很快消失	政府的新政策一出，市場謠言如湯沃雪般消失。|經過耐心解釋，誤會如湯沃雪，瞬間消失無蹤。	ru2 tang1 wo4 xue3
10 比喻與誇張	恆河沙數	恆河沙子的數量	形容數量極多	宇宙中的星球如恆河沙數般多不勝數。|這裡的問題恆河沙數，多得讓人不知從何下手。	heng2 he2 sha1 shu4
10 比喻與誇張	星羅棋布	星星散落如棋子佈局有序	形容分布眾多而有秩序	夜空中繁星星羅棋布，美不勝收。|這座城市中的古跡星羅棋布，到處都是歷史的印記。	xing1 luo2 qi2 bu4
10 比喻與誇張	一󠇢言九鼎	一句話的分量如同九個鼎那麼重	形容說話極有分量	他的承諾如一言九鼎，大家都十分信賴。|他在公司中的地位極高，一言九鼎，決策具有極大的影響力。	yi1 yan2 jiu3 ding3
10 比喻與誇張	鏡花水月	虛幻如鏡中的花和水中的月亮	比喻虛幻不實的事物	他的承諾如鏡花水月，終究是一場空。|那些美好的記憶，如今卻像鏡花水月般虛幻不實。	jing4 hua1 shui3 yue4
11 批評與諷刺	暴殄天物	暴殄糟蹋上天賜予的物品	糟蹋物品	把好食材做成難吃的菜，真是暴殄天物。|這麼好的食材被浪費掉，簡直是暴殄天物。	bao4 tian3 tian1 wu4
11 批評與諷刺	兩腳書櫥	兩條腿的書櫃	比喻只讀書而不學以致用的人	他雖然博覽群書，卻是個兩腳書櫥，不懂實際運用。|這位學者博學多才，真可謂兩腳書櫥，知識豐富。	liang3 jiao3 shu1 chu2
11 批評與諷刺	故步自封	守住舊的步伐，自我封閉	守舊不肯改進	在科技快速發展的今天，故步自封將會落後。|如果總是故步自封，不願意接受新事物，必然會落後於時代。	gu4 bu4 zi4 feng1
11 批評與諷刺	食古不󠇡化	吃了古代的東西卻不消化	只知道模仿古人，不知變通	他的思想食古不化，無法適應新時代。|他雖然讀過許多書，但食古不化，思想仍然陳舊。	shi2 gu3 bu4 hua4
11 批評與諷刺	品頭論足	品評頭，議論腳	對人或事物品頭論足	比賽結束後，觀眾們紛紛品頭論足。|他對每件事都喜歡品頭論足，總是挑剔不滿。	pin3 tou2 lun4 zu2
11 批評與諷刺	畫虎類狗	畫老虎卻畫得像狗	拙劣的模仿	他自詡為書法家，但作品實在是畫虎類狗。|他模仿名家作畫，但結果卻畫虎類狗，讓人失望。	hua4 hu3 lei4 gou3
11 批評與諷刺	江郎才盡	江郎的才華用盡了	才思枯竭	這位作家近年作品平平，似乎有江郎才盡之勢。|這位作家近期作品平平，似乎江郎才盡，難以超越過去的輝煌。	jiang1 lang2 cai2 jin4
11 批評與諷刺	梧鼠技窮	梧桐樹上的老鼠技能窮盡了	比喻才能已到盡頭	面對強勁對手，他很快就梧鼠技窮。|他雖然掌握了一些技巧，但在面對困難時卻梧鼠技窮，無計可施。	wu2 shu3 ji4 qiong2
11 批評與諷刺	空穴來風	謠言如空洞穴有風吹來	比喻沒有根據的傳言	這個傳言並非空穴來風，確有其事。|這些流言蜚語純屬空穴來風，毫無根據。	kong1 xue2 lai2 feng1
12 成語中的智慧	戶樞不󠇡蠹	門樞不會被蟲蛀	比喻經常做事的人不會生疏	老王從事教育工作多年，經驗豐富，可謂戶樞不蠹。|俗話說，戶樞不蠹，流水不腐，保持活動才能保持活力。	hu4 shu1 bu4 du4
12 成語中的智慧	垂拱而治	垂衣拱手就能治理天下	無為而治	這位領導善於用人，幾近垂拱而治。|在他的治理下，國家安定繁榮，真是垂拱而治。	chui2 gong3 er2 zhi4
12 成語中的智慧	繼往開來	繼承過去開創未來	繼承前人，開創未來	新一代領導人繼往開來，推動國家進步。|我們應繼往開來，將前人的精神發揚光大，迎接未來挑戰。	ji4 wang3 kai1 lai2
12 成語中的智慧	惜墨如金	珍惜墨如同黃金	珍惜文字如同珍惜黃金	古代紙墨昂貴，學子們惜墨如金。|這位書法家惜墨如金，每一筆都下得十分謹慎。	xi1 mo4 ru2 jin1
`;

let dictData = `
a1	阿啊腌
a4	阿
a5	啊
ai1	哀哎唉埃挨
ai2	呆挨捱皚癌
ai3	矮噯藹靄
ai4	艾愛隘噯曖璦礙
an1	安氨庵陰菴銨鞍諳鵪
an3	俺
an4	岸按案菴暗黯
ang1	腌骯
ang2	昂
ang4	盎
ao1	凹熬
ao2	敖嗷熬遨翱聱鏖鰲鼇
ao3	夭拗媼襖
ao4	拗敖傲奧懊澳燠
ba1	八巴叭扒吧芭疤捌笆
ba2	拔跋鈸
ba3	把靶
ba4	伯把杷爸耙罷霸壩灞
ba5	吧杷琶罷
bai2	白
bai3	百伯把佰柏擺襬
bai4	拜敗稗
ban1	扳班般斑搬頒瘢
ban3	阪板版舨鈑闆
ban4	半伴扮姅拌絆辦瓣
bang1	邦梆傍幫
bang3	綁榜膀
bang4	並旁蚌傍棒徬膀磅謗鎊
bao1	包炮胞苞剝裒褒
bao2	雹薄
bao3	保堡葆飽褓寶
bao4	刨抱豹袍報鉋暴鮑瀑爆鑤
bei1	卑杯盃背俾埤悲揹碑箄襬
bei3	北
bei4	北孛貝怫邶背倍悖狽婢被備焙菩蓓僻輩鋇憊臂避
ben1	奔賁
ben3	本苯畚
ben4	奔笨
beng1	崩繃
beng2	甭
beng3	繃
beng4	泵蚌迸榜磅繃蹦
bi1	逼箄
bi2	荸鼻
bi3	匕比妣沘彼筆鄙
bi4	比必佛庇拂泌俾祕秘陛埤婢敝畢閉弼愎詖費賁跛痺睥辟逼鉍嗶幣弊碧箄裨鄙蔽壁篦斃臂薜避璧蹕襞
bian1	砭編蝙鞭邊
bian3	扁匾貶蝙褊
bian4	卞弁汴釆便遍辨辮辯變
biao1	杓彪標膘鏢鑣
biao3	表婊錶
biao4	鰾
bie1	鱉
bie2	扒別
bie3	癟
bie4	彆
bin1	份彬稟賓儐濱豳檳瀕繽
bin4	賓儐殯臏鬢
bing1	冰并兵屏檳
bing3	丙秉屏柄炳迸稟鉼餅
bing4	并並併柄病摒
bo1	波玻剝般缽菠撥
bo2	白百伯孛佰帛拍泊勃柏悖脖舶荸博渤菔搏鈸鉑雹箔膊駁蔔薄爆簿
bo3	跛簸
bo4	北亳捭播擘檗薄薜簸蘗
bo5	蔔
bu1	誧
bu2	不
bu3	卜哺埔捕補
bu4	不布佈步怖哺捕埠部鈽簿
ca1	搽擦
cai1	猜
cai2	才材財裁纔
cai3	采彩採睬綵踩
cai4	采菜蔡
can1	參餐
can2	殘慚蠶
can3	慘歜
can4	孱粲摻燦璨
cang1	倉傖滄蒼艙
cang2	藏
cao1	操橾糙
cao2	曹嘈漕槽
cao3	草
cao4	造操橾糙
ce4	冊側廁惻測策
cen1	參
cen2	岑涔
ceng2	曾層
cha1	叉差喳插
cha2	叉岔查茶搽察
cha3	叉
cha4	岔剎差詫
chai1	拆差釵
chai2	柴豺儕齜
chai3	冊
chai4	差
chan1	摻攙
chan2	單孱嶄嬋潺澶毚禪蟬蟾巉纏讒饞
chan3	產剷諂鏟闡
chan4	儳懺羼顫
chang1	昌倀倡娼猖鯧
chang2	長倘常徜場萇腸嘗嫦裳償嚐
chang3	場敞廠氅
chang4	倡唱悵暢
chao1	抄超鈔勦
chao2	晁啁巢朝嘲潮
chao3	吵炒
chao4	鈔
che1	車
che3	尺扯
che4	坼拆掣徹撤澈轍
chen1	琛瞋
chen2	臣忱沈沉辰宸晨陳塵諶
chen4	疢趁稱闖櫬襯讖
cheng1	槍稱撐瞠鎗鐺
cheng2	丞成呈承城乘崢盛傖程誠澄橙懲
cheng3	逞騁
cheng4	秤稱
chi1	吃蚩笞喫嗤痴癡魑
chi2	尺弛池治泜持匙痴馳墀踟遲癡
chi3	尺呎侈恥豉齒褫
chi4	叱斥赤翅敕啻飭熾
chong1	充忡沖舂憧衝
chong2	虫重崇蟲
chong3	寵
chong4	衝
chou1	抽
chou2	仇圳惆愁稠酬綢裯儔濤鯈疇籌躊
chou3	丑醜
chou4	臭
chu1	出初齣
chu2	芻除屠裯廚鋤儲雛櫥躇
chu3	杵處楮楚褚儲礎
chu4	怵畜絀處歜黜觸矗
chua3	抓
chuai3	揣
chuai4	踹
chuan1	川穿
chuan2	船傳
chuan3	舛喘
chuan4	串釧
chuang1	囪創窗瘡
chuang2	床幢撞
chuang3	搶闖
chuang4	創愴闖
chui1	吹炊
chui2	垂捶椎陲槌箠綞錘鎚
chui4	吹炊
chun1	春椿
chun2	唇純淳脣醇鶉
chun3	蠢
chuo1	戳
chuo4	啜綽輟鏃齪
ci1	差恣疵雌
ci2	玆祠茨茲瓷疵詞慈磁雌辭
ci3	此
ci4	次伺刺廁賜
cong1	匆囪從樅蔥聰叢
cong2	從淙叢
cou4	湊輳
cu1	粗
cu4	卒促戚數槭趣醋錯簇趨蹙蹴鏃
cuan4	篡竄爨
cui1	衰崔催摧
cui3	璀
cui4	脆悴淬萃瘁粹翠
cun1	村皴
cun2	存蹲
cun3	忖
cun4	寸吋
cuo1	差搓撮磋蹉
cuo2	嵯
cuo4	昔厝挫措撮銼錯
da1	答搭褡躂
da2	打怛答達靼瘩韃
da3	打
da4	大
da5	瘩
dai1	呆待
dai3	歹得逮
dai4	大代岱待怠殆玳迨帶袋貸逮戴黛
dan1	丹眈耽單湛鄲擔簞
dan3	疸撢膽
dan4	旦石但啖啗淡蛋氮彈憚誕鴆擔澹
dang1	當儅噹襠鐺
dang3	當擋檔黨讜
dang4	當儅蕩檔盪
dao1	刀叨
dao3	倒島搗導禱
dao4	到倒悼盜道導稻濤蹈檮燾
de2	得德
de5	地底的得
dei3	得
deng1	登燈
deng3	等
deng4	凳嶝鄧瞪磴蹬
di1	氐低堤提隄滴鏑
di2	狄的迪笛荻嘀嫡滌翟敵適鏑
di3	氐底抵邸柢牴砥詆
di4	地弟芍的帝娣第棣逮蒂遞締諦
dian1	拈滇顛巔癲
dian3	典碘點
dian4	佃甸店玷惦奠殿鈿電墊澱靛
diao1	刁叼凋彫貂碉雕鯛
diao3	鳥
diao4	弔吊掉釣調
die1	爹
die2	凸佚迭喋絰耋跌牒碟蝶諜褶鰈鐵疊
ding1	丁仃叮盯釘
ding3	酊頂鼎
ding4	定訂釘錠
diu1	丟
dong1	冬和咚東鼕
dong3	董懂
dong4	峒恫洞凍胴動棟湩
dou1	兜都
dou3	斗抖枓蚪陡
dou4	豆鬥脰逗痘竇讀
du1	都督嘟
du2	毒頓獨瀆櫝牘犢讀髑黷
du3	肚竺堵睹賭篤
du4	妒杜肚度渡鍍蠹
duan1	耑端
duan3	短
duan4	段緞鍛斷
dui1	追堆敦
dui4	兌敦隊碓對
dun1	惇敦墩燉蹲
dun3	盹躉
dun4	囤沌盾敦鈍飩遁頓噸燉
duo1	多
duo2	多奪鐸
duo3	朵躲綞
duo4	剁咄度舵惰跺馱墮踱
e1	阿婀
e2	俄哦娥峨蚵訛蛾額鵝
e3	我婀惡
e4	厄歹呃扼俄啞堊軛惡愕鄂萼詻遏隘餓噩鍔額顎鱷
eh1	掖
en1	恩嗯
en5	嗯
er2	而兒
er3	耳洱爾餌邇
er4	二貳
fa1	伐法發醱
fa2	乏伐法筏罰閥
fa3	法砝髮
fa4	法琺
fan1	反帆番幡蕃繙翻
fan2	凡氾帆釩煩墦樊蕃繁藩礬
fan3	反返
fan4	反氾犯汎泛范梵販飯範
fang1	方坊妨枋肪芳
fang2	坊妨防房肪
fang3	仿彷放倣紡舫訪
fang4	放
fei1	妃非飛啡扉斐菲蜚霏
fei2	肥腓
fei3	非匪斐菲翡誹
fei4	吠怫沸肺芾屝菲費痱廢
fen1	分吩氛芬紛棻
fen2	汾焚賁頒墳
fen3	扮粉
fen4	分份忿焚噴墳憤奮糞
feng1	丰封風峰烽楓蜂瘋鋒諷豐
feng2	逢馮縫
feng3	泛
feng4	奉風俸鳳諷縫
fo2	佛
fou1	不
fou2	芣浮
fou3	不缶否
fou4	復
fu1	不夫伕孚趺鈇孵敷膚麩
fu2	夫弗伏佛孚扶彿怫拂服沸芙芾俘氟浮匐涪符紱紼幅菔袱福蔽蝠縛輻
fu3	父甫府斧俯釜脯莆腑腐輔撫頫
fu4	仆父付咐阜附訃負赴副埠婦傅富復腹複賦駙賻覆馥
ga1	嘎
ga2	軋嘎噶
ga4	尬
ga5	價
gai1	垓該賅
gai3	改
gai4	丐溉鈣概蓋
gan1	干甘杆肝坩柑竿疳乾尷
gan3	桿敢稈感趕橄
gan4	旰淦幹榦贛
gang1	亢扛杠肛岡缸剛崗釭綱鋼韁
gang3	岡崗港
gang4	杠槓鋼
gao1	咎皋羔高睪膏篙糕
gao3	杲搞槁稿縞鎬攪
gao4	告膏誥
ge1	戈疙咯紇哥胳割歌擱鴿
ge2	咯郃革格鬲蛤葛隔膈閣閤頜噶翮骼鎘
ge3	合個葛箇蓋
ge4	各個箇鉻
ge5	個箇
gei3	給
gen1	根跟
gen3	艮
gen4	亙艮
geng1	更庚耕粳賡羹
geng3	哽埂耿梗頸
geng4	亙更
gong1	工弓公功共攻供肱紅宮恭蚣躬龔
gong3	廾共汞拱鞏礦
gong4	共供虹貢贛
gou1	勾句枸區溝鉤
gou3	狗枸苟
gou4	勾句垢逅夠媾搆詬雊構遘購
gu1	估呱咕姑孤沽家骨蛄菰辜鈷鴣轂
gu2	骨
gu3	凸古估谷股牯罟骨詁滑賈鈷鼓穀轂瞽鵠蠱
gu4	估告固故雇僱錮顧
gua1	瓜刮呱括聒蝸颳
gua3	寡
gua4	卦挂掛褂
guai1	乖
guai3	拐枴
guai4	坏怪壞
guan1	官冠矜倌莞棺綸瘝關鰥觀
guan3	莞琯斡管館
guan4	串冠貫慣盥灌鰥罐觀鸛
guang1	光洸胱
guang3	廣獷
guang4	逛
gui1	圭皈珪規傀瑰閨龜鮭歸
gui3	究癸軌桅鬼晷詭
gui4	桂貴會跪匱劊檜櫃蹶鱖
gun3	混袞渾滾輥鯀
gun4	棍琯
guo1	郭堝渦過蟈鍋
guo2	國幗摑
guo3	果猓裹槨
guo4	過
ha1	哈
ha2	蛤蝦
ha3	哈
hai1	咳嗨
hai2	孩骸還
hai3	海
hai4	亥害氦駭
han1	蚶酣鼾
han2	汗含函邯涵寒幹榦韓
han3	罕喊
han4	汗含旱和悍捍焊感漢銲頜憾撼翰頷瀚
hang1	肛
hang2	行吭沆杭桁航
hang4	行沆桁
hao1	蒿
hao2	毫嗥號貉豪嚎壕濠蠔鶴
hao3	好郝
hao4	好昊浩耗涸皓號鄗鎬顥
he1	呵喝訶
he2	禾合何劾和河曷紇苛郃害核盍涸盒荷渴嗑貉鉀蓋閡閤褐翮闔
he4	和郝荷喝賀黑暍赫嚇豁鶴
hei1	黑嘿
hei3	黑
hen2	痕
hen3	很狠
hen4	恨
heng1	亨哼
heng2	亨恆桁橫衡
heng4	橫
hong1	哄烘薨轟
hong2	弘宏泓洪紅虹烘訌閎嶸鴻黌
hong3	哄
hong4	鬨
hou2	侯喉猴篌
hou3	吼
hou4	后厚後候逅堠鱟
hu1	乎呼忽虎惚糊戲
hu2	乎囫和弧狐胡斛壺湖瑚葫糊蝴醐鵠鬍
hu3	虎唬許琥
hu4	互戶沍怙扈瓠雇楛滬糊穫護
hua1	化花華嘩
hua2	划華滑猾劃嘩豁譁
hua4	化畫華話劃踝樺
huai2	徊淮槐踝獲懷
huai4	坏壞
huan1	歡鸛
huan2	洹桓寰澴環還鍰
huan3	皖緩
huan4	幻奐宦患喚換渙煥豢瘓
huang1	肓荒慌
huang2	皇凰徨惶湟隍黃煌遑篁蝗璜磺簧韹
huang3	恍洸晃幌謊
huang4	晃
huang5	慌
hui1	灰恢虺揮暉詼墮輝麾徽戲
hui2	回徊茴迴蛔
hui3	虫虺悔會毀賄誨燬
hui4	卉沬彗晦喙惠匯彙會賄誨慧潰蕙諱燴穢繪
hun1	昏婚葷
hun2	混渾琿魂餛
hun3	混
hun4	混渾
huo1	豁
huo2	活
huo3	火伙夥
huo4	和或貨惑禍霍壑擭濩獲豁穫
huo5	和
ji1	几乩肌其奇居唧姬屐飢基嵇幾期棋犄萁勣畸跡箕嘰畿稽機激璣積磯績蹟雞譏饑躋羈
ji2	及伋吃吉即圾岌汲亟急革唧疾級脊寂揖棘集嫉戢楫極劇瘠輯擊藉籍
ji3	几己紀脊幾戟給麂擠濟
ji4	妓忌技其季疙芰既洎紀計記寄悸祭暨際齊稷冀劑髻濟薊覬薺騎鯽繫繼霽驥
jia1	加伽夾佳茄迦家痂袈傢葭嘉豭
jia2	夾俠挾浹戛莢頰
jia3	甲胛夏假賈鉀
jia4	甲夾架假嫁鉀價稼駕
jian1	奸尖肩姦兼堅淺湔菅閒間煎漸監箋緘縑尷艱濺殲鶼韉
jian3	囝柬剪揀減筧儉撿錢檢瞼簡繭騫鹼
jian4	件見建荐健閒間毽煎腱僭漸監儉劍澗箭賤踐諫餞薦鍵檻濺艦鑑鑒
jiang1	江姜將僵漿薑疆韁
jiang3	槳獎蔣講
jiang4	匠降將強絳彊醬
jiao1	交咬姣郊教梟喬椒焦蛟詨跤嬌澆膠蕉礁鮫驕
jiao2	嚼
jiao3	角姣狡皎絞剿勦腳較僥鉸餃矯繳攪
jiao4	叫校教窖較酵轎醮嚼覺
jie1	皆偕接揭結街階嗟
jie2	孑劫杰拮桀桔砝訐捷傑渴結睫節詰截碣竭潔羯頡櫛鍥擷
jie3	姊姐解
jie4	介尬戒屆芥界疥借械嗟解誡藉
jin1	巾今斤金津矜觔浸筋禁襟
jin3	僅緊瑾儘錦覲謹饉
jin4	近勁晉浸進僅禁盡瑾噤縉燼覲饉
jing1	歹更京青涇耕荊旌莖晶菁睛粳經兢精鯨驚
jing3	井阱景憬璟頸警
jing4	勁徑淨脛逕竟痙敬靖境靜鏡競
jiong3	炯迥窘
jiu1	究糾赳啾揪鳩
jiu3	九久灸玖糾赳韭酒愀
jiu4	臼究咎疚柩救就廄舅舊
ju1	且車居拘沮狙俱疽砠蛆駒鋸
ju2	局侷桔掬菊跼鴃橘鞠
ju3	咀沮枸矩莒舉齟
ju4	句巨足具拒沮炬苣俱倨距鉅聚劇踞據鋸屨遽颶瞿懼
juan1	身娟捐涓圈鵑鐫
juan3	卷捲
juan4	卷倦狷圈眷絹雋
jue1	嗟
jue2	孓抉決角玨倔崛掘訣厥絕腳較劂獗鴃噱蕨爵譎蹶嚼覺觼攫鱖
jue3	蹶
jue4	倔
jun1	君均軍鈞龜
jun3	窘
jun4	俊峻浚郡竣菌雋濬駿
ka1	咖哈喀
ka3	卡咯咳
ka4	喀
kai1	揩開
kai3	豈凱剴慨愷楷
kai4	愒慨愾轄
kan1	刊看勘堪戡
kan3	坎侃砍崁嵌檻
kan4	看勘瞰
kang1	康慷糠
kang2	扛
kang3	慷骯
kang4	亢伉抗炕
kao3	考拷烤
kao4	犒銬靠
ke1	刻柯科苛蚵棵軻稞窠瞌磕蝌顆髁
ke2	咳殼
ke3	可坷棵渴顆
ke4	可克刻剋客恪喀嗑溘緙課髁
ken3	肯啃墾懇齦
ken4	啃
keng1	吭坑阬傾鏗
keng3	肯
kong1	空倥崆硿
kong3	孔倥恐
kong4	空控
kou3	口
kou4	叩扣佝寇釦
ku1	枯哭窟骷
ku3	苦楛
ku4	苦庫酷褲
kua1	夸誇
kua3	垮
kua4	胯跨
kuai4	快塊會筷儈劊檜膾
kuan1	寬髖
kuan3	梡款
kuang1	匡劻眶筐
kuang2	狂誑
kuang4	況框眶壙曠礦
kui1	盔窺虧
kui2	奎揆逵葵睽魁夔
kui3	傀揆
kui4	喟愧匱潰歸簣餽
kun1	坤昆崑混焜琨髡錕
kun3	捆梱綑
kun4	困睏
kuo4	括蛞廓闊擴
la1	拉啦喇邋
la2	剌邋
la3	喇
la4	剌落辣臘蠟
la5	啦
lai2	來徠萊
lai4	來徠睞厲賴懶瀨癩籟
lan2	婪嵐闌藍攔瀾籃襤斕欄蘭籣
lan3	懶覽攬欖纜
lan4	濫瀾爛
lang2	郎浪狼琅廊榔瑯螂羹
lang3	朗
lang4	浪
lao1	撈
lao2	牢勞嘮撈癆
lao3	老佬姥潦
lao4	烙勞絡落酪樂潦
le4	叻肋垃勒樂
le5	了
lei1	勒
lei2	累雷嫘擂縲羸鐳
lei3	耒累磊儡蕾壘
lei4	肋淚累擂類
leng1	愣
leng2	楞稜蔆
leng3	冷
leng4	怔愣楞
li1	哩
li2	浬狸梨犁喱漓蜊貍犛璃黎罹釐離麗蠡籬驪
li3	李里俚哩娌浬理喱裡鋰澧禮鯉醴蠡邐
li4	力叻立吏利例戾俐栗荔鬲唳捩琍笠粒莉痢慄溧蒞厲曆歷勵隸癘鎘壢瀝麗礪礫儷蠣酈欐靂
li5	哩
lia3	倆
lian2	帘連廉零奩漣憐蓮濂聯簾鏈鐮鰱
lian3	臉
lian4	楝煉練斂殮鍊鏈瀲戀攣
liang2	良亮梁涼量粱樑諒糧
liang3	兩倆魎
liang4	亮涼晾量諒輛
liao1	撩
liao2	聊僚寥嘹寮撩潦燎遼療繆繚
liao3	了暸燎瞭
liao4	料廖燎瞭
lie1	咧
lie2	咧
lie3	咧
lie4	列劣冽洌烈捩裂獵邋鬣
lin2	林淋琳痳鄰燐璘遴霖磷臨轔鱗麟
lin3	稟凜懍
lin4	吝賃遴轔藺躪
ling1	拎昤
ling2	伶泠昤玲苓凌羚翎聆蛉陵菱鈴零綾蔆鴒齡櫺靈
ling3	領嶺
ling4	令另
liu1	溜
liu2	流琉留硫榴遛劉瘤瀏餾
liu3	柳
liu4	六陸溜遛霤餾
lo5	咯
long2	隆龍窿嚨朧瓏矓籠聾
long3	壟攏隴籠
long4	弄
lou1	摟
lou2	婁嘍摟樓螻髏
lou3	摟簍
lou4	陋漏瘺鏤露
lou5	嘍
lu1	嚕
lu2	盧廬瀘爐臚蘆鑪顱鱸
lu3	鹵虜滷魯擄櫓
lu4	六角陸鹿氯僇碌祿賂路綠戮穋錄麓露鷺
luan2	孿巒攣灤鑾鸞
luan3	卵
luan4	亂
lue4	掠略
lun1	掄
lun2	侖倫圇崙掄淪綸論輪
lun4	論
luo1	囉
luo2	螺羅鏍儸騾囉玀蘿邏籮鑼
luo3	虜裸擄
luo4	咯洛烙珞絡碌落酪漯犖雒駱濕
lv2	閭櫚驢
lv3	呂侶旅婁屢膂履鋁縷褸
lv4	律率氯綠慮壘濾
lvan2	孿攣
ma1	媽摩螞嬤
ma2	麻痲嘛麼蟆
ma3	馬嗎瑪碼螞
ma4	罵螞
ma5	嗎嘛麼蟆
mai2	埋霾
mai3	買
mai4	脈麥賣邁
man1	屘
man2	埋漫蔓瞞蹣饅鰻蠻
man3	滿
man4	曼幔慢漫蔓縵鏝
mang2	忙杗芒氓盲茫
mang3	莽蟒
mao1	摸貓
mao2	毛矛茅髦犛錨
mao3	卯泖茆鉚
mao4	冒茂耄帽貿瑁貌懋
me5	麼
mei2	沒枚玫眉梅莓媒湄楣煤霉糜黴
mei3	每美鎂
mei4	妹沬昧袂媚寐瑁魅謎
men1	悶燜
men2	門們捫
men4	悶燜懣
men5	們
meng1	矇
meng2	氓虻萌盟蒙甍濛朦檬懵矇
meng3	猛艋蜢錳懵
meng4	孟夢
mi1	咪瞇
mi2	迷彌糜謎麋靡瀰
mi3	米羋弭敉靡瀰
mi4	日糸汨泌祕秘密覓蜜冪謎謐
mian2	眠棉綿
mian3	免沔勉娩偭冕湎緬頫靦
mian4	面瞑麵
miao2	苗描瞄
miao3	杪眇秒渺緲藐邈
miao4	妙廟繆
mie1	羋咩
mie4	滅蔑篾
min2	民岷玟閩
min3	皿抿泯敏湣閔愍閩憫澠
ming2	名明冥茗酩暝銘鳴瞑螟
ming3	皿冥茗酩瞑
ming4	命暝
miu4	繆謬
mo1	摸
mo2	無摸麼摩摹模膜磨糢謨蘑魔
mo3	抹麼
mo4	末沒佰抹歿沫沬冒茉陌秣脈莫麥貉貊寞幕漠嘿膜墨磨默驀
mou2	牟眸謀繆
mou3	牡某畝
mou4	茂貿懋
mu2	模
mu3	母牡姆拇姥畝
mu4	木目沐牧苜莫募睦墓幕慕暮穆繆鶩
na1	那
na2	南拿
na3	那哪
na4	內吶那娜納捺訥鈉
nai3	乃奶氖迺
nai4	奈耐
nan1	囝
nan2	男南喃楠難
nan3	赧
nan4	難
nang2	囊
nang3	曩
nao2	呶撓橈鐃
nao3	惱瑙腦
nao4	鬧
ne4	訥
ne5	呢
nei3	那哪餒
nei4	內那
nen4	嫩
neng2	能
ni2	尼兒呢妮怩泥倪霓
ni3	你妳旎擬
ni4	泥逆匿溺睨暱膩
nian2	年拈黏
nian3	拈涊捻撚碾輦輾攆
nian4	廿念唸
niang2	娘孃
niang4	釀
niao3	鳥嫋裊嬝
niao4	尿溺
nie1	捏捻
nie4	涅臬業聶鎳孽囁攝齧躡鑷
nin2	您
ning2	寧凝嚀擰獰檸
ning3	擰
ning4	佞寧擰濘
niu1	妞
niu2	牛
niu3	忸扭紐鈕
niu4	拗
nong2	農儂噥濃膿穠
nong4	弄
nou4	耨
nu2	奴帑駑
nu3	努弩
nu4	怒
nuan3	暖煖燸
nue4	虐瘧
nuo2	那哪娜挪
nuo4	諾懦糯
nv3	女
nv4	女
o1	呵啊喔
o2	哦
ou1	區嘔歐毆甌鷗
ou3	偶嘔歐耦藕
ou4	嘔
pa1	拍趴啪葩
pa2	扒杷爬耙琶
pa4	帕怕
pa5	杷琶
pai1	拍
pai2	俳徘排牌箄
pai3	排
pai4	派湃
pan1	扳番潘攀
pan2	弁胖般槃盤磐踫蟠蹣
pan4	判拌拚叛盼胖畔
pang1	乓胖滂膀磅
pang2	彷旁傍徬膀螃龐
pang4	胖
pao1	拋泡
pao2	刨咆庖炮匏袍跑
pao3	跑
pao4	泡炮皰砲
pei1	坏呸披胚
pei2	坏培陪裴賠
pei4	妃沛佩肺珮配轡
pen1	噴
pen2	盆
pen4	噴
peng1	亨抨砰烹硼澎
peng2	朋旁逢彭棚硼澎蓬膨篷龐鵬
peng3	捧
peng4	碰踫
pi1	匹丕疋坏批披紕被鈹劈霹
pi2	比皮枇陂毗疲紕啤埤陴琵脾鈹裨罷鼙
pi3	匹疋仳否痞劈癖
pi4	屁副埤媲辟僻癖譬闢
pian1	片扁偏篇翩
pian2	平便胼褊駢
pian4	片遍辨騙
piao1	票嫖漂飄
piao2	嫖瓢
piao3	漂標瞟縹
piao4	票剽漂縹驃
pie1	撇瞥
pie3	撇
pin1	姘拼
pin2	貧頻嬪瀕蘋顰
pin3	品
pin4	牝聘
ping1	乒娉
ping2	平坪屏枰秤瓶萍評馮憑蘋
ping4	聘
po1	坡波陂頗潑
po2	婆番鄱繁
po3	叵頗
po4	朴拍泊珀迫破釙粕魄醱霸
pou1	剖
pou2	裒
pou3	剖培
pu1	仆扑噗撲鋪
pu2	朴匍脯莆菩葡僕蒲樸璞濮蹼
pu3	哺圃埔浦普溥誧譜
pu4	堡暴鋪瀑曝
qi1	七妻柒悽戚淒期棲欺萋溪漆慼緝谿
qi2	示圻岐其奇枝歧祁俟祇祈耆衹崎淇畦期棋琦琪祺旗齊畿錡臍薺騎麒鰭
qi3	乞杞豈起啟綺稽
qi4	乞企吱汽迄亟妻泣契砌氣訖愒揭棄緝器憩磧
qia3	卡
qia4	恰洽
qian1	千仟阡牽嵌愆鉛搴遷謙簽騫籤韆
qian2	前柑虔乾鈐腱鉗箝潛錢黔
qian3	淺遣譴
qian4	欠倩嵌塹歉縴謙
qiang1	羌將強腔嗆搶槍鎗鏘
qiang2	戕強彊檣牆薔
qiang3	強搶彊繈
qiang4	嗆
qiao1	雀跤鄗敲撬橇橾鍬蹺
qiao2	招喬僑憔樵橋蕉瞧翹譙
qiao3	巧悄雀愀鵲
qiao4	俏峭殼誚撬鞘竅翹譙
qie1	切
qie2	伽茄
qie3	且
qie4	切妾怯契砌挈愜鍥竊
qin1	侵欽嶔親
qin2	芹矜秦琴覃勤禽凜噙擒
qin3	寢
qin4	沁撳
qing1	青卿氫清頃傾蜻輕請鯖
qing2	情晴請擎檠
qing3	頃請
qing4	慶磬親罄
qiong1	穹
qiong2	穹窮瓊
qiu1	丘邱秋蚯龜鞦鰍
qiu2	仇囚求泅酋梂毬球裘
qu1	曲屈區蛆蛐嶇趨瞿軀驅
qu2	劬渠璩瞿麴衢
qu3	曲取娶齲
qu4	去娶漆趣覷
quan1	悛圈
quan2	全佺卷泉拳荃痊筌詮蜷銓踡權鸛
quan3	犬甽畎
quan4	券圈勸
que1	缺闕
que2	瘸
que4	怯卻恪雀殼榷確闋闕鵲
qun2	群裙
ran2	然髯燃
ran3	冉染苒
rang1	嚷
rang2	攘瓤禳鑲
rang3	嚷壤攘
rang4	讓
rao2	嬈蟯饒
rao3	嬈擾
rao4	繞
re3	若惹
re4	熱
ren2	人儿仁壬任妊
ren3	忍荏稔
ren4	刃仞任妊紉衽軔韌飪賃認
reng1	扔
reng2	仍扔
reng3	扔
reng4	扔
ri4	入日
rong2	戎容茸絨溶頌榕榮熔蓉融嶸鎔
rong3	冗茸
rou2	柔揉蹂鞣
rou4	肉
ru2	如茹需儒嚅孺濡燸蠕
ru3	入女汝乳辱追
ru4	入肉茹辱追褥
ruan3	阮軟燸蠕
rui3	蕊
rui4	瑞睿銳
run4	閏潤
ruo4	若弱偌篛鶸
sa1	三撒
sa3	撒灑
sa4	卅颯蔡薩
sai1	思塞腮鰓
sai4	塞賽
san1	三參
san3	傘散糝
san4	三散
sang1	桑喪
sang3	嗓
sang4	喪
sao1	搔艘橾繅騷
sao3	掃嫂
sao4	掃燥
se4	色圾嗇塞瑟澀穡
sei1	塞
sen1	森
seng1	僧
sha1	杉沙剎砂紗殺莎煞裟鯊
sha3	傻
sha4	殺廈煞霎
shai1	篩
shai3	色骰
shai4	晒殺曬
shan1	山刪杉姍芟珊舢衫扇跚摻煽潸縿羶
shan3	閃陝摻
shan4	汕疝柵扇訕善單擅膳禪繕贍鱔
shang1	商湯傷裳殤觴
shang3	上晌賞
shang4	上尚
shao1	捎梢稍燒鞘
shao2	勺杓芍招韶
shao3	少
shao4	少召邵哨捎紹稍
she1	奢賒
she2	什舌折甚蛇
she3	舍捨
she4	色社舍拾射庫涉設赦葉歙懾攝麝
shei2	誰
shen1	申伸身呻信娠砷參深紳莘
shen2	什甚神
shen3	沈哂審嬸瀋
shen4	甚脤腎慎蜃滲
sheng1	升生昇牲陞笙勝甥聲
sheng2	澠繩
sheng3	省
sheng4	乘盛剩勝聖賸
shi1	尸失虱屍拾施師溼獅詩蝨濕
shi2	十什石拾食射時提塒實碩蝕
shi3	史矢弛豕使始屎駛
shi4	士氏世仕市示式事使侍始室恃拭是柿舐視豉逝勢嗜弒筮試軾飾誓奭適噬螫識釋
shi5	匙
shou1	收
shou2	熟
shou3	手守首
shou4	守受狩售授壽綬瘦濤獸
shu1	疋抒俞書殊梳荼疏舒樞蔬輸橾
shu2	朱叔孰淑菽塾熟贖
shu3	暑黍署蜀鼠數薯藷屬
shu4	戍束述倏恕庶術疏署墅漱數豎樹曙
shua1	刷
shua3	耍
shua4	刷
shuai1	衰摔
shuai3	甩
shuai4	帥率蟀
shuan1	拴閂栓
shuan4	涮諼踹
shuang1	霜雙孀
shuang3	爽塽
shuang4	雙
shui2	誰
shui3	水
shui4	稅睡蛻說
shun3	吮盾
shun4	舜順瞬
shuo1	說
shuo4	勺妁芍帥朔率碩數蟀爍鑠
si1	司糸私思斯絲嘶廝撕鷥
si3	死
si4	巳四寺伺似兕姒泗祀俟思食笥耜廁嗣肆飼賜駟
song1	忪松崧淞嵩鬆
song2	悚
song3	悚慫聳
song4	宋送訟頌誦
sou1	叟搜蒐艘餿颼
sou3	叟嗾擻藪
sou4	嗽漱擻
su1	甦疏酥蔬穌蘇囌
su2	俗
su4	夙素宿速粟訴嗉塑溯肅數蓿簌縮
suan1	痠酸
suan4	算蒜
sui1	睢綏雖
sui2	隋綏遂隨雖
sui3	髓
sui4	祟術歲碎遂誶隧燧穗邃
sun1	孫飧蓀
sun3	筍損榫
sun4	孫巽遜潠
suo1	唆娑衰梭莎嗦蓑簑縮
suo2	索
suo3	所索瑣鎖
suo4	些
ta1	他它她佗牠塌
ta3	塔獺
ta4	拓達榻漯遝遢踏撻濕蹋獺躂
tai1	台胎苔
tai2	台抬苔跆臺颱檯薹
tai4	大太汰泰態
tan1	坍探貪攤灘癱
tan2	覃痰彈潭談壇曇澹檀罈譚
tan3	坦袒毯
tan4	炭探嘆碳撢歎
tang1	湯鏜
tang2	唐堂棠塘搪瑭膛糖螳醣鏜
tang3	帑倘淌躺儻
tang4	趟燙
tao1	叨掏滔絛濤韜饕
tao2	洮桃逃啕淘陶萄濤檮燾
tao3	討
tao4	套
tao5	萄
te4	特貸慝
teng2	疼滕謄藤騰籐
ti1	剔梯踢
ti2	啼堤提隄緹蹄醍題
ti3	體
ti4	弟剃悌涕屜惕逖啻替棣摘銻嚏
tian1	天添
tian2	田佃甸恬畋甜填鈿闐
tian3	忝殄腆舔靦
tiao1	佻挑
tiao2	佻挑迢條蜩調
tiao3	挑窕
tiao4	眺覜跳頫
tie1	帖貼
tie3	帖鐵
tie4	帖餮
ting1	汀听聽廳
ting2	廷亭庭停婷蜓霆
ting3	挺梃艇
ting4	听聽
tong1	恫通
tong2	同彤峒洞桐童僮銅潼瞳
tong3	桶筒統
tong4	同痛慟
tou1	偷
tou2	投骰頭
tou4	透
tou5	頭
tu1	凸禿
tu2	凸突徒屠荼途菟塗圖酴
tu3	土吐
tu4	吐兔菟
tuan1	湍
tuan2	團糰
tui1	推
tui2	頹
tui3	腿
tui4	退脫蛻褪
tun1	吞
tun2	屯囤豚飩臀
tun4	褪
tuo1	他它托佗牠拓拖託脫
tuo2	它佗沱陀迤跎馱駝鴕
tuo3	妥橢
tuo4	拓柝唾魄
wa1	凹汙呱哇挖媧蛙窪
wa2	娃挖
wa3	瓦
wa4	凹瓦襪
wa5	哇
wai1	歪
wai3	歪
wai4	外
wan1	剜莞蜿豌彎灣
wan2	丸汍完玩頑
wan3	宛娩挽婉晚莞皖碗綰蜿輓
wan4	玩惋曼腕萬
wang1	尢汪
wang2	亡王忘
wang3	往枉罔惘網輞魍
wang4	王妄忘旺望
wei1	委威倭偎崴萎逶微煨
wei2	危圩為韋桅唯帷惟圍幃微違維濰薇闈魏巍
wei3	尾委洧娓偉唯猥萎痿葦緯諉鮪
wei4	未位味為畏胃偽尉喂渭慰蔚衛謂遺褽餵穢魏
wen1	玟塭溫瘟
wen2	文玟紋蚊雯聞
wen3	刎吻穩
wen4	文免抆汶紊問聞
weng1	翁嗡
weng3	蓊
weng4	甕
wo1	倭渦萵窩
wo3	我倭
wo4	沃臥喔握渥斡齷
wu1	圬汙污巫於屋烏喔惡嗚誣鎢
wu2	亡毋吳吾巫唔梧無蜈誣蕪鼯
wu3	五午伍武侮捂舞嫵憮鵡
wu4	兀勿戊汙沃物悟務晤梧惡塢寤誤霧騖
xi1	兮西吸希析屎唏奚悉晞淅烯畦訢晰棲犀稀溪僖熙蜥嘻嬉撕膝熹羲禧蟋谿蹊釐譆曦犧攜
xi2	昔席息惜習媳熄蓆錫檄濕褶襲
xi3	洗徙喜屣禧璽鰓
xi4	夕汐系矽係細翕愾隙潟歙戲繫
xia1	呀瞎蝦
xia2	匣邪呷狎俠柙洽峽挾狹斜暇瑕遐轄霞黠
xia4	下夏廈暇煆嚇
xian1	仙先姍秈祆掀暹鮮纖
xian2	弦咸啣涎絃舷閑閒嫌銜嫻賢鹹
xian3	洗蜆銑險鮮蘚癬顯
xian4	先見限峴現莧陷羨腺僩線賢憲縣餡獻霰
xiang1	相香廂湘鄉箱襄瓖鑲
xiang2	羊庠降祥翔詳
xiang3	享想餉響饗
xiang4	向巷相象鄉項像樣橡鬨嚮
xiao1	削枵哮宵消梟逍硝跤嘐銷霄蕭簫瀟囂驍
xiao2	爻肴絞餚
xiao3	小曉篠
xiao4	孝肖芍哮效校笑傚詨酵嘯
xie1	些楔歇蠍
xie2	邪協頁挾脅偕斜勰鞋頡諧鮭擷攜
xie3	血寫蟹
xie4	卸泄契洩屑械紲楔解榭寫懈燮褻謝邂瀉蟹
xin1	心辛昕欣芯莘訢新鋅薪馨
xin2	尋
xin4	芯信蕈釁
xing1	星惺猩腥興醒馨
xing2	刑行形邢型陘硎
xing3	省惺醒
xing4	行杏姓幸性倖悻興
xiong1	凶兄兇匈洶胸
xiong2	雄熊
xiu1	休咻修羞脩
xiu3	休朽宿
xiu4	秀岫臭宿袖嗅溴繡鏽
xu1	于吁戌胥訏虛須嘔需噓墟鬚
xu2	余邪徐
xu3	休咻栩許煦
xu4	旭序卹恤洫畜敘勗酗婿絮頊緒蓄續
xuan1	宣晅軒喧暄暖煖萱諼壎燸
xuan2	玄旋漩縣還璿懸
xuan3	選癬
xuan4	炫眩旋渲絢鉉漩
xue1	靴噱薛
xue2	穴學
xue3	雪
xue4	穴血削雪
xun1	勛葷勳壎燻薰醺
xun2	旬巡徇洵荀尋循詢馴潯
xun4	汛迅徇孫殉訊訓巽馴遜潠蕈
ya1	丫疋呀亞押啞雅鴉鴨壓
ya2	牙押芽蚜涯睚衙
ya3	疋亞啞雅
ya4	亞軋御訝揠氬
yai2	崖
yan1	奄咽殷胭淹焉湮腌菸煙厭嫣醃燕
yan2	言岩延沿炎妍研鉛筵閻檐癌顏簷嚴巖鹽
yan3	奄兗衍偃掩眼郾演縯儼鼴魘
yan4	沿咽彥研俺唁宴晏涎淹堰焰硯雁厭燄燕諺嚥贗饜驗艷鹽釅豔
yang1	央泱殃秧鞅鴦
yang2	羊佯徉洋烊揚陽暘楊煬瘍鍚颺
yang3	仰氧鞅養癢
yang4	怏恙煬漾樣養
yao1	么夭凹吆妖要喲腰邀
yao2	爻肴姚洮崤淆陶堯搖僥榣瑤遙窯餚謠
yao3	夭杳咬窈舀嬈
yao4	要樂曜藥耀鷂鑰
ye1	耶掖噎
ye2	邪耶斜琊椰爺
ye3	也冶野
ye4	曳夜咽拽頁射掖液喝腋暍業葉曄謁鄴靨
yi1	一伊衣依咿施壹揖椅漪噫翳醫
yi2	一台圯夷听沂迆宜怡咦姨施迤栘益胰訑痍移蛇貽飴熙疑儀誼遺頤彝
yi3	乙已以尾矣迆迤倚偯椅蛾旖蟻
yi4	一弋刈亦屹曳艾衣佚役抑邑佾易泄疙芸奕帟弈施洩疫羿食射浥益掖液異翌腋軼逸意溢睪義肄裔詣蜴億毅誼劓噫憶縊翳翼臆鎰繹藝譯議囈懿驛
yin1	因姻音殷氤茵陰湮慇
yin2	吟圻言垠寅淫夤鄞銀霪齦
yin3	尹引听殷蚓飲縯隱癮
yin4	印胤音陰飲暈蔭隱
ying1	英瑛嬰應膺韹嚶罌櫻瓔鶯纓鷹鸚
ying2	迎盈塋楹熒瑩嬴縈螢營瀛蠅贏
ying3	郢景影穎
ying4	迎映硬應
yo1	唷
yong1	邕庸傭雍慵鄘壅擁臃
yong2	庸傭慵鄘
yong3	永甬泳臾俑勇涌恿湧詠蛹壅擁踴臃
yong4	用佣
you1	攸幽悠憂優
you2	尤由油疣游猶郵猷遊鈾魷鯈
you3	友有那酉莠牖黝
you4	又右幼有佑侑囿宥柚疣祐莠釉鈾誘鼬
yu1	汙迂紆淤瘀
yu2	于予圩汙余吾妤邪於盂臾俞禺竽娛雩魚愉渝腴菸萸隅愚榆瑜虞衙逾漁與蝓褕諛餘覦輿歟
yu3	予宇羽雨禹圄圉庾敔與語噢嶼齬
yu4	王玉聿芋谷拗育雨俞昱禺苑郁峪浴唷域堉尉御欲雩喻寓粥馭奧愈毓煜裕遇預嫗獄瘉與語慾熨蔚澦澳禦諭豫燠癒譽鬱籲
yuan1	宛怨冤淵鳶鴛
yuan2	元沅京垣爰苑原員袁媛援湲園圓源猿隕緣轅騵
yuan3	遠
yuan4	怨苑原院媛愿遠緣願
yue1	曰約
yue4	月刖囝岳玥悅軏越粵說樂閱嶽曜耀躍籥鑰
yun1	暈氳
yun2	云勻昀芸員紜耘雲筠
yun3	允隕
yun4	孕均員慍暈運熨醞韻蘊
za1	匝紮臢
za2	列咱砸偺雜
zai1	災哉栽
zai3	仔宰載
zai4	再在載
zan1	簪
zan2	咱偺
zan4	暫贊鏨瓚讚
zang1	戕臧贓髒臢
zang3	髒
zang4	奘葬藏臟
zao1	槽遭糟
zao2	鑿
zao3	早蚤棗澡藻
zao4	灶皂草造漕噪燥譟躁
ze2	咋則柞窄笮責賊嘖擇澤
ze3	怎
ze4	仄側
zei2	賊
zen1	簪
zen3	怎
zeng1	曾增憎繒
zeng4	繒贈
zha1	扎查喳渣
zha2	扎札軋炸紮喋閘
zha3	扎眨砟渣詐
zha4	乍吒咋柵炸砟笮蚱詐搾榨
zhai1	摘齊齋
zhai2	宅翟擇
zhai3	窄
zhai4	柴祭責債寨
zhan1	占佔沾詹霑氈瞻譫
zhan3	展斬盞嶄輾
zhan4	占佔站棧湛綻暫戰顫蘸
zhang1	張章彰漳獐樟璋蟑
zhang3	長掌漲
zhang4	丈仗杖長帳張脹幛漲障賬瘴
zhao1	抓招昭釗朝著嘲
zhao2	著
zhao3	爪找沼
zhao4	召兆炤棹詔照罩肇趙櫂
zhe1	折遮螫
zhe2	折哲蜇摺輒靼褶謫轍囁懾
zhe3	者摺赭遮
zhe4	宅浙這蔗鷓
zhe5	著
zhei4	這
zhen1	歹珍貞唇振真砧針偵診斟楨榛甄禎箴臻
zhen3	枕疹診縝
zhen4	圳枕娠振朕陣陳賑震鴆鎮
zheng1	丁正疋征怔爭崢掙猙睜蒸箏徵諍錚鯖癥
zheng3	拯整
zheng4	正疋政症掙幀証鄭證
zhi1	之支氏卮只汁吱枝泜知肢芝祇胝祗脂衹隻梔蜘織
zhi2	拓直姪值執植殖跖摭質擲職躑
zhi3	止只旨址抵芷咫指祉紙趾徵
zhi4	至志制治炙知峙致值秩痔窒智痣蛭稚置輊雉滯製誌幟摯緻質遲識躓
zhong1	中忪忠盅衷終鍾鐘
zhong3	冢塚腫種踵
zhong4	中仲重眾湩種粽
zhou1	州舟周洲啁粥週調
zhou2	妯軸
zhou3	肘帚
zhou4	咒宙冑紂胄晝軸皺縐籀
zhu1	列朱侏株珠茱硃蛛誅跦銖諸豬藷
zhu2	朮竹妯竺草逐筑軸築燭躅
zhu3	主拄枓渚煮貯屬囑矚
zhu4	佇住助杼注柱苧祝蛀粥著註箸駐鑄
zhua1	抓撾
zhua3	爪
zhuai1	拽
zhuai4	拽
zhuan1	耑專磚顓
zhuan3	轉囀
zhuan4	傳僎撰篆賺轉饌
zhuang1	妝莊裝樁
zhuang3	奘
zhuang4	壯狀僮幢撞
zhui1	隹追椎錐
zhui4	惴綴墜贅
zhun1	屯肫諄
zhun3	准純準
zhuo1	卓捉桌涿棹
zhuo2	灼卓拙斫茁酌啄琢著濁擢濯繳鐲
zi1	仔次吱孜咨姿恣玆茲淄孳滋訾貲資緇齊輜諮錙髭齜
zi3	子仔姊籽梓紫滓訾
zi4	字自恣眥孳漬
zi5	子
zong1	宗從棕縱蹤鬃
zong3	傯縱總
zong4	從粽綜縱
zou1	陬鄒鄹
zou3	走
zou4	奏揍驟
zu1	租
zu2	足卒族嗾鏃
zu3	阻俎祖組詛
zuan1	鑽
zuan3	纂鑽
zuan4	賺鑽
zui3	嘴
zui4	最罪撮醉蕞
zun1	尊樽遵
zun3	撙
zun4	圳
zuo1	作
zuo2	作昨撮
zuo3	左佐撮
zuo4	作坐柞座祚做醋鑿
`;

const dictMap = new Map(dictData.trim().split('\n').map(line => {
    const [pinyin, chars] = line.split('\t');
	const charsSplit = Array.from(chars);
    return [pinyin, charsSplit];
}));

function getPinyinArray(pinyinString) {
    return pinyinString.split(/ +/);
}

function getRandomCharForPinyin(pinyin, excludeChars) {
    const chars = dictMap.get(pinyin) || [];
    const availableChars = chars.filter(char => !excludeChars.includes(char));
    return availableChars[Math.floor(Math.random() * availableChars.length)];
}


function removeBPMCharacters(str) {
    return str.replace(/[󠇠󠇡󠇢󠇣󠇤󠇥󠇦󠇧󠇨󠇩]/gu, '');
}

const idioms = idiomsData.trim().split('\n').slice(1).map(line => {
    const [分類, 成語, 字面意思, 表達意思, 例句, 拼音] = line.split('\t');
    const idiomNoBPM = removeBPMCharacters(成語);
    return { 分類, 成語, idiomNoBPM, 字面意思, 表達意思, 例句, 拼音 };
});

        const categories = [...new Set(idioms.map(idiom => idiom.分類))];
        const categorySelect = document.getElementById('category-select');
        categories.forEach(category => {
            const option = document.createElement('option');
            option.value = category;
            option.textContent = category;
            categorySelect.appendChild(option);
        });

let currentIdioms = [];
let selectedLeft = null;
let selectedRight = null;
let matchType = '成語-表達意思';
// const matchType = document.getElementById('match-type-select').value;
let currentIndex = 0;
let orderedIdioms = [];
let totalRounds = 0;
let currentRound = 0;
const idiomsPerRound = 4;
let startTime;
let correctPairs = 0;
let totalPairs = 0;
let isSoundOn = true;
let currentCategoryIndex = 0;
let currentFont = 'BpmfZihiSans-Regular';
let currentFontState = 'zih';
let currentFontSize = '1.3em';
const idiomLocalName = "j01";

const happyEmojis = "🥰😛🤗😄😍🤩😘😚😋😊😆😁😄😃";
const sadEmojis = "😟😮🥺😧😨😥😢😭😱😖😩😤";

const rightAudio = new Audio('right.mp3');
const wrongAudio = new Audio('wrong.mp3');

function playAudio(audio) {
    if (isSoundOn) {
        audio.currentTime = 0;
        audio.play();
    }
}

// 從 localStorage 讀取錯誤記錄
function getErrorRecords() {
    const records = localStorage.getItem(`${idiomLocalName}_errorRecords`);
    return records ? JSON.parse(records) : {};
}

// 保存錯誤記錄到 localStorage
function saveErrorRecords(records) {
    localStorage.setItem(`${idiomLocalName}_errorRecords`, JSON.stringify(records));
}

// 更新錯誤記錄
function updateErrorRecord(idiom) {
    const records = getErrorRecords();
    records[idiom] = (records[idiom] || 0) + 1;
    saveErrorRecords(records);
}

// 清除錯誤記錄
function clearErrorRecords() {
    localStorage.removeItem(`${idiomLocalName}_errorRecords`);
}

document.getElementById('sound-button').onclick = toggleSound;

function toggleFont() {
    const fontToggleButton = document.getElementById('font-toggle-button');
	const ListfontToggleButton = document.getElementById('list-font-toggle-button');

    const leftItems = document.querySelectorAll('.left-item');
	const idioms = document.querySelectorAll('.idiom');

    switch(currentFontState) {
        case 'zih':
            currentFontState = 'box';
            fontToggleButton.textContent = '框';
			ListfontToggleButton.textContent = '框';
			currentFont = 'BpmfZihiBox-R';
			currentFontSize = '1.4em';

			leftItems.forEach(item => {
				item.style.fontFamily = 'BpmfZihiBox-R';
				item.style.fontSize = '1.4em';
			});
			idioms.forEach(item => {
				item.style.fontFamily = 'BpmfZihiBox-R';
				item.style.fontSize = '1.4em';
				item.style.minWidth = '160px';
			});
            break;
        case 'box':
            currentFontState = 'bpmf';
            fontToggleButton.textContent = '音';
			ListfontToggleButton.textContent = '音';
			currentFont = 'BpmfZihiOnly-R';
			currentFontSize = '2em';

			leftItems.forEach(item => {
				item.style.fontFamily = 'BpmfZihiOnly-R';
				item.style.fontSize = '2em';
			}); 
			idioms.forEach(item => {
				item.style.fontFamily = 'BpmfZihiOnly-R';
				item.style.fontSize = '1.6em';
				item.style.minWidth = '120px';
			}); 
            break;
        case 'bpmf':
            currentFontState = 'zih';
            fontToggleButton.textContent = '字';
			ListfontToggleButton.textContent = '字';
			currentFont = 'BpmfZihiSans-Regular';
			currentFontSize = '1.3em';

			leftItems.forEach(item => {
				item.style.fontFamily = 'BpmfZihiSans-Regular';
				item.style.fontSize = '1.3em';
			}); 
			idioms.forEach(item => {
				item.style.fontFamily = 'BpmfZihiSans-Regular';
				item.style.fontSize = '1em';
				item.style.minWidth = '120px';

			}); 
            break;
    }
}

function toggleSound() {
    isSoundOn = !isSoundOn;
    const soundButton = document.getElementById('sound-button');
    soundButton.textContent = isSoundOn ? '🔔' : '🔕';
}

function showEndButton() {
    const endButton = document.getElementById('end-button');
    endButton.classList.add('visible');
}

function hideEndButton() {
    const endButton = document.getElementById('end-button');
	endButton.blur();
    endButton.classList.remove('visible');
}

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

        function selectItem(item, side) {
            if (side === 'left') {
                if (selectedLeft) {
                    selectedLeft.classList.remove('selected');
                }
                selectedLeft = item;
            } else {
                if (selectedRight) {
                    selectedRight.classList.remove('selected');
                }
                selectedRight = item;
            }
            item.classList.add('selected');

            if (selectedLeft && selectedRight) {
                checkMatch();
            }
        }

	function stringToArray(str) {
		return Array.from(str.match(/\P{RI}\p{RI}?\p{RI}?/gu) ?? []);
	}

	function getRandomEmoji(emojiString) {
		const emojiArray = stringToArray(emojiString);
		return emojiArray[Math.floor(Math.random() * emojiArray.length)];
	}

	function changeEmoji(isCorrect) {
		const character = document.getElementById('character');
		if (isCorrect) {
			character.textContent = getRandomEmoji(happyEmojis);
			character.classList.add('animated');

			/*
			setTimeout(() => {
				character.textContent = '🙂';
				character.classList.remove('animated');
			}, 2000);
			*/
		} else {
			character.textContent = getRandomEmoji(sadEmojis);
			character.classList.add('animated');
		}
	}



    function checkMatch() {
        const leftText = selectedLeft.textContent;
        const rightText = selectedRight.textContent;
        const correctPair = currentIdioms.find(pair => pair.left === leftText && pair.right === rightText);
		const leftItems = document.querySelectorAll('.left-item');
		const nextButton = document.getElementById('next-button');
		const endButton = document.getElementById('end-button');

        if (correctPair) {
			correctPairs++;
			playAudio(rightAudio);
            selectedLeft.style.backgroundColor = '#4CAF50';
            selectedRight.style.backgroundColor = '#4CAF50';
            selectedLeft.style.pointerEvents = 'none';
            selectedRight.style.pointerEvents = 'none';
			selectedLeft.classList.add('correct');
			selectedRight.classList.add('correct');
            selectedLeft = null;
            selectedRight = null;
            changeEmoji(true);

            if (document.querySelectorAll('.left-item:not([style*="pointer-events: none"])').length === 0) {
    			leftItems.forEach(item => {
					item.style.fontFamily = 'BpmfZihiSans-Regular';
					item.style.fontSize = '1.3em';
				});  
				if(currentRound >= totalRounds){
					showEndButton();
					endButton.focus();									
				} else {
					showNextButton();
					showEndButton();
					nextButton.focus();
				}
            }
        } else {
			playAudio(wrongAudio);
			changeEmoji(false);
			updateErrorRecord(selectedLeft.textContent);
			setTimeout(() => {
				selectedLeft.classList.remove('selected');
				selectedRight.classList.remove('selected');
				selectedLeft = null;
				selectedRight = null;
			}, 100);
		}
		totalPairs++;
    }


function showResult() {
    const endTime = new Date();
    const timeSpent = Math.round((endTime - startTime) / 1000);
    const accuracy = Math.round((correctPairs / totalPairs) * 100);

    document.getElementById('accuracy-progress').style.width = `${accuracy}%`;

    document.getElementById('accuracy').textContent = `✨正確：${accuracy}%`;
    document.getElementById('total-rounds').textContent = `🎡回合：${currentRound}`;
    document.getElementById('time-spent').textContent = `⏰努力：${timeSpent} 秒`;
    document.getElementById('selected-category').textContent = `📒分類：${categorySelect.options[categorySelect.selectedIndex].text}`;
    document.getElementById('match-type-result').textContent = `🪧配對：${document.getElementById('match-type-select').options[document.getElementById('match-type-select').selectedIndex].text}`;
    
    const orderSelect = document.getElementById('order-select');
    const orderText = orderSelect.options[orderSelect.selectedIndex].text;
    document.getElementById('order-type-result').textContent = `🏷️順序：${orderText}`;

    updateClearRecordsButton();

    document.getElementById('game').style.display = 'none';
    document.getElementById('result').style.display = 'block';
}

document.getElementById('end-button').onclick = function() {
    showResult();
};

document.getElementById('return-to-setup').onclick = function() {
    document.getElementById('result').style.display = 'none';
	initializeCategories();
	resetGame();	
};

        function showNextButton() {
            const nextButton = document.getElementById('next-button');		
            nextButton.classList.add('visible');
        }

        function hideNextButton() {
            const nextButton = document.getElementById('next-button');
			nextButton.blur();
            nextButton.classList.remove('visible');
        }

function getOrderedIdioms() {
    const selectedCategory = categorySelect.value;
    let filteredIdioms;

    if (selectedCategory === '常錯挑戰') {
        const errorRecords = getErrorRecords();
        filteredIdioms = idioms.filter(idiom => errorRecords.hasOwnProperty(idiom.成語));
        
        if (document.getElementById('order-select').value === 'sequential') {
            filteredIdioms.sort((a, b) => errorRecords[b.成語] - errorRecords[a.成語]);
        }
    } else {
        filteredIdioms = selectedCategory === 'all' ? 
            idioms.slice() : idioms.filter(idiom => idiom.分類 === selectedCategory);
    }

    return filteredIdioms;
}


function updateProgress() {
    const progress = document.getElementById('progress');
    const roundInfo = document.getElementById('round-info');
    progress.style.width = `${(currentRound / totalRounds) * 100}%`;
    roundInfo.textContent = `${currentRound}/${totalRounds}`;
}

function resetGame() {
    currentIndex = 0;
    currentRound = 0;
    orderedIdioms = [];
    correctPairs = 0;
    totalPairs = 0;
    hideEndButton();
    hideNextButton();
    document.getElementById('setup').classList.add('active');
    document.getElementById('setup').style.display = 'block';
    document.getElementById('game').classList.remove('active');
    document.getElementById('game').style.display = 'none';
	
}

function getRandomExample(examples) {
    const exampleArray = examples.split('|');
    return exampleArray[Math.floor(Math.random() * exampleArray.length)].trim();
}

// 出題;

function startNewRound() {
    const selectedCategory = categorySelect.value;
    const orderType = document.getElementById('order-select').value;

    const nextButton = document.getElementById('next-button');
    const endButton = document.getElementById('end-button');
    nextButton.blur();
    endButton.blur();

    if (currentIndex === 0 || currentIndex >= orderedIdioms.length) {
        orderedIdioms = getOrderedIdioms();
        if (orderType === 'random' || (selectedCategory === '常錯挑戰' && orderType === 'sequential')) {
            shuffleArray(orderedIdioms);
        }
        currentIndex = 0;
        // 根據遊戲模式設置 totalRounds
        if (matchType === '成語-排序') {
            totalRounds = orderedIdioms.length;  // 排序模式下，每個成語都是一個回合
        } else {
            totalRounds = Math.ceil(orderedIdioms.length / idiomsPerRound);
        }
        
        currentRound = 0;
    }




    currentRound++;
    updateProgress();

    if (matchType === '成語-排序') {
        const idiom = orderedIdioms[currentIndex];
        setupSortingGame(idiom);
        currentIndex++;
    } else {
        // 顯示左右配對容器，隱藏排序容器
        document.getElementById('left-right-container').style.display = 'block';
        document.getElementById('sorting-container').style.display = 'none';
        currentIdioms = [];
        for (let i = 0; i < idiomsPerRound && currentIndex < orderedIdioms.length; i++) {
            const idiom = orderedIdioms[currentIndex];
            let pair;
            switch (matchType) {
                case '成語-表達意思':
                    pair = { left: idiom.成語, right: idiom.表達意思 };
                    break;
                case '成語-字面意思':
                    pair = { left: idiom.成語, right: idiom.字面意思 };
                    break;
                case '成語-例句':
                    const randomExample = getRandomExample(idiom.例句);
                    const maskedSentence = randomExample.replace(idiom.idiomNoBPM, '🙈');
                    pair = { left: idiom.成語, right: maskedSentence };
                    break;
            }
            currentIdioms.push(pair);
            currentIndex++;
        }

        const leftContainer = document.getElementById('leftContainer');
        const rightContainer = document.getElementById('rightContainer');

        leftContainer.innerHTML = '';
        rightContainer.innerHTML = '';

        // 創建左側選項
        const leftItems = currentIdioms.map(pair => pair.left);

        leftItems.forEach(item => {
            const leftElement = document.createElement('div');
            leftElement.className = 'left-item';
            leftElement.style.fontFamily = currentFont;
            leftElement.style.fontSize = currentFontSize;        
            leftElement.textContent = item;
            leftElement.onclick = () => selectItem(leftElement, 'left');
            leftContainer.appendChild(leftElement);
        });

        // 創建右側選項（始終隨機排序）
        const rightItems = currentIdioms.map(pair => pair.right);
        shuffleArray(rightItems);
        rightItems.forEach(item => {
            const rightElement = document.createElement('div');
            rightElement.className = 'right-item';
            rightElement.textContent = item;
            rightElement.onclick = () => selectItem(rightElement, 'right');
            rightContainer.appendChild(rightElement);
        });
    }

    if (currentRound === 1) {
        startTime = new Date();
    }
}



function setupSortingGame(idiom) {
    const pinyinArray = getPinyinArray(idiom.拼音);
    const correctChars = Array.from(idiom.idiomNoBPM);
    const wrongChars = pinyinArray.map(pinyin => 
        getRandomCharForPinyin(pinyin, correctChars)
    ).filter(char => char); // 過濾掉可能的 undefined

    const allChars = [...correctChars, ...wrongChars];
    shuffleArray(allChars);

    // 隱藏左右配對容器，顯示排序容器
    document.getElementById('left-right-container').style.display = 'none';
    document.getElementById('sorting-container').style.display = 'block';

    // 更新成語問題
    const idiomQuestion = document.getElementById('idiom-question');
    idiomQuestion.textContent = idiom.成語;
    idiomQuestion.style.fontFamily = 'BpmfZihiOnly-R';
    idiomQuestion.style.fontSize = '2em';

    // 清空並填充答案區和選項區
    const answerArea = document.getElementById('answer-area');
    const characterOptions = document.getElementById('character-options');
    answerArea.innerHTML = '';
    characterOptions.innerHTML = '';

    allChars.forEach(char => {
        const charElement = document.createElement('div');
        charElement.className = 'character-option';
        charElement.textContent = char;
        characterOptions.appendChild(charElement);
    });

    setupClickHandlers();

    // 重新綁定確定按鈕的事件
    const checkButton = document.getElementById('check-answer');
    checkButton.onclick = () => checkSortingAnswer(idiom);
    checkButton.disabled = true; // 初始時禁用確定按鈕
}

function setupClickHandlers() {
    const answerArea = document.getElementById('answer-area');
    const characterOptions = document.getElementById('character-options');
    
    // 移除舊的事件監聽器
    characterOptions.removeEventListener('click', handleCharacterOptionClick);
    answerArea.removeEventListener('click', handleAnswerAreaClick);

    // 使用事件委派
    characterOptions.addEventListener('click', handleCharacterOptionClick);
    answerArea.addEventListener('click', handleAnswerAreaClick);
}

function handleCharacterOptionClick(e) {
    if (e.target.classList.contains('character-option')) {
        const charElement = e.target.cloneNode(true);
        charElement.classList.add('in-answer');
        document.getElementById('answer-area').appendChild(charElement);
        e.target.style.display = 'none';
		updateCheckButtonState();
    }
}

function handleAnswerAreaClick(e) {
    if (e.target.classList.contains('in-answer')) {
        const char = e.target.textContent;
        const originalOption = Array.from(document.getElementById('character-options').children)
            .find(el => el.textContent === char && el.style.display === 'none');
        if (originalOption) {
            originalOption.style.display = '';
        }
        e.target.remove();
		updateCheckButtonState();
    }
}

function updateCheckButtonState() {
    const answerArea = document.getElementById('answer-area');
    const checkButton = document.getElementById('check-answer');
    const currentIdiom = orderedIdioms[currentIndex - 1];
    checkButton.disabled = answerArea.children.length !== currentIdiom.idiomNoBPM.length;
}
	

function checkSortingAnswer(idiom) {
    const answerArea = document.getElementById('answer-area');
    const characterOptions = document.getElementById('character-options');
    const checkButton = document.getElementById('check-answer');
    const userAnswer = Array.from(answerArea.children).map(el => el.textContent).join('');
    const nextButton = document.getElementById('next-button');
    const endButton = document.getElementById('end-button');

    if (userAnswer === idiom.idiomNoBPM) {
        // 答案正確
        playAudio(rightAudio);
        changeEmoji(true);
        correctPairs++;
        if (currentRound >= totalRounds) {
            showEndButton();
            endButton.focus();                                  
        } else {
            showNextButton();
            showEndButton();
            nextButton.focus();
        }
        checkButton.disabled = true; // 禁用確定按鈕，防止重複點擊
    } else {
        // 答案錯誤
        playAudio(wrongAudio);
        changeEmoji(false);
        updateErrorRecord(idiom.成語);

        // 將答案區的元素依序移回選項區
        const answerElements = Array.from(answerArea.children);
        answerElements.forEach(char => {
            // 找到對應的原始選項
            const originalOption = Array.from(characterOptions.children)
                .find(el => el.textContent === char.textContent && el.style.display === 'none');
            
            if (originalOption) {
                // 如果找到原始選項，則恢復其顯示
                originalOption.style.display = '';
            } else {
                // 如果沒找到原始選項（不應該發生），則創建一個新的
                const newOption = char.cloneNode(true);
                newOption.classList.remove('in-answer');
                newOption.classList.add('character-option');
                characterOptions.appendChild(newOption);
            }
            
            // 移除答案區的元素
            char.remove();
        });
        
        checkButton.disabled = true; // 重置後禁用確定按鈕
    }
    totalPairs++;
}

        document.getElementById('next-button').onclick = function() {
            hideNextButton();
			hideEndButton();
            startNewRound();
        };

document.getElementById('start-button').onclick = function() {
    matchType = document.getElementById('match-type-select').value;
    document.getElementById('setup').classList.remove('active');
    document.getElementById('setup').style.display = 'none';
    document.getElementById('game').classList.add('active');
    document.getElementById('game').style.display = 'block';

    currentIndex = 0;
    currentRound = 0;
    orderedIdioms = [];
    startNewRound();
};

document.getElementById('close-button').onclick = function() {
    resetGame();	
};



document.getElementById('view-idioms-button').onclick = function() {
	currentFont = 'BpmfZihiSans-Regular';
	currentFontState = 'zih';
	currentFontSize = '1.3em';
    const fontToggleButton = document.getElementById('font-toggle-button');
	const ListfontToggleButton = document.getElementById('list-font-toggle-button');
	fontToggleButton.textContent = '字';
	ListfontToggleButton.textContent = '字';
    document.getElementById('setup').style.display = 'none';
    document.getElementById('idiom-list').style.display = 'block';
    renderIdiomList(); 
};

document.getElementById('close-idiom-list').onclick = function() {
    document.getElementById('idiom-list').style.display = 'none';
    document.getElementById('setup').style.display = 'block';
};



function replaceIdiomWithUnderscore(sentence, idiom) {
    return sentence.replace(new RegExp(idiom, 'g'), '🙈');
}

function renderIdiomList() {
    const selectedCategory = document.getElementById('category-select').value;
    const table = document.getElementById('idiom-table');
    const tbody = table.querySelector('tbody');
    tbody.innerHTML = '';

    // 篩選成語
    let filteredIdioms;
    if (selectedCategory === '常錯挑戰') {
        const errorRecords = getErrorRecords();
        filteredIdioms = idioms.filter(idiom => errorRecords.hasOwnProperty(idiom.成語));
        filteredIdioms.sort((a, b) => errorRecords[b.成語] - errorRecords[a.成語]);
    } else {
        filteredIdioms = selectedCategory === 'all' 
            ? idioms 
            : idioms.filter(idiom => idiom.分類 === selectedCategory);
    }

    filteredIdioms.forEach((idiom, index) => {
        const randomExample = getRandomExample(idiom.例句);
        const row = document.createElement('tr');
        row.innerHTML = `
            <td class="category"><small>${idiom.分類}</small></td>
            <td><small class="small-number">${index + 1} </small><span class="idiom">${idiom.成語}</span></td>
            <td class="literal">${idiom.字面意思}</td>
            <td class="figurative">${idiom.表達意思}</td>
            <td class="example">${replaceIdiomWithUnderscore(randomExample, idiom.idiomNoBPM)}</td>
        `;
        tbody.appendChild(row);
    });

	const idiomList = document.querySelectorAll('.idiom');
    idiomList.forEach(item => {
		item.style.fontFamily = currentFont;
    });

    updateVisibility();
    updateCategoryNavigation();
}

function updateVisibility() {
    const showCategory = document.getElementById('show-category').checked;
    const showIdiom = document.getElementById('show-idiom').checked;
    const showLiteral = document.getElementById('show-literal').checked;
    const showFigurative = document.getElementById('show-figurative').checked;
    const showExample = document.getElementById('show-example').checked;

    document.querySelectorAll('#idiom-table .category').forEach(el => el.style.display = showCategory ? '' : 'none');
    document.querySelectorAll('#idiom-table .idiom').forEach(el => el.style.display = showIdiom ? '' : 'none');
    document.querySelectorAll('#idiom-table .literal').forEach(el => el.style.display = showLiteral ? '' : 'none');
    document.querySelectorAll('#idiom-table .figurative').forEach(el => el.style.display = showFigurative ? '' : 'none');
    document.querySelectorAll('#idiom-table .example').forEach(el => el.style.display = showExample ? '' : 'none');
}

document.querySelectorAll('.idiom-controls input[type="checkbox"]').forEach(checkbox => {
    checkbox.addEventListener('change', updateVisibility);
});

document.getElementById('category-select').addEventListener('change', function() {
    renderIdiomList();
    updateCategoryNavigation();
});

function updateCategoryNavigation() {
    const categorySelect = document.getElementById('category-select');
    const prevButton = document.getElementById('prev-category');
    const nextButton = document.getElementById('next-category');
    const categories = Array.from(categorySelect.options).map(option => option.value);
    currentCategoryIndex = categories.indexOf(categorySelect.value);

    prevButton.disabled = currentCategoryIndex <= 1;  // 禁用"全部"的上一個
    nextButton.disabled = currentCategoryIndex >= categories.length - 1;

    if (currentCategoryIndex > 0) {
        prevButton.textContent = "< "  + categories[currentCategoryIndex - 1];
    }
    if (currentCategoryIndex < categories.length - 1) {
        nextButton.textContent = categories[currentCategoryIndex + 1] + " >";
    }
}

function changeCategory(direction) {
    const categorySelect = document.getElementById('category-select');
    const categories = Array.from(categorySelect.options).map(option => option.value);
    
    currentCategoryIndex += direction;
    if (currentCategoryIndex < 1) currentCategoryIndex = 1;  // 不要選到"全部"
    if (currentCategoryIndex >= categories.length) currentCategoryIndex = categories.length - 1;

    categorySelect.value = categories[currentCategoryIndex];
    renderIdiomList();
    updateCategoryNavigation();
}

document.getElementById('prev-category').onclick = () => changeCategory(-1);
document.getElementById('next-category').onclick = () => changeCategory(1);

updateCategoryNavigation();

document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('font-toggle-button').addEventListener('click', toggleFont);
	document.getElementById('list-font-toggle-button').addEventListener('click', toggleFont);	
});

document.getElementById('clear-records').onclick = function() {
    if (confirm('確定要清除所有錯誤記錄嗎？')) {
        clearErrorRecords();
        alert('錯誤記錄已清除');        
        // 清除記錄後，需要更新類別列表，移除「常錯挑戰」選項
        initializeCategories();
        
        // 如果當前在「常錯挑戰」類別，則切換到「所有分類」
        if (categorySelect.value === '常錯挑戰') {
            categorySelect.value = 'all';
        }        
        // 更新類別導航按鈕
        updateCategoryNavigation();
        // 更新清除紀錄按鈕狀態
        updateClearRecordsButton();
    }
};

function initializeCategories() {
    const categories = ['all', ...new Set(idioms.map(idiom => idiom.分類))];
    const categorySelect = document.getElementById('category-select');
    categorySelect.innerHTML = '';

    categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category === 'all' ? 'all' : category;
        option.textContent = category === 'all' ? '所有分類' : category;
        categorySelect.appendChild(option);
    });

    const errorRecords = getErrorRecords();
    if (Object.keys(errorRecords).length > 0) {
        const errorOption = document.createElement('option');
        errorOption.value = '常錯挑戰';
        errorOption.textContent = '常錯挑戰';
        categorySelect.appendChild(errorOption);
    }
}

function updateClearRecordsButton() {
    const clearRecordsButton = document.getElementById('clear-records');
    const errorRecords = getErrorRecords();
    const hasErrors = Object.keys(errorRecords).length > 0;
    
    clearRecordsButton.disabled = !hasErrors;
    clearRecordsButton.style.opacity = hasErrors ? '1' : '0.5';
    clearRecordsButton.style.cursor = hasErrors ? 'pointer' : 'not-allowed';
}

// 在頁面載入時調用此函數
document.addEventListener('DOMContentLoaded', initializeCategories);

    </script>
</body>
</html>
